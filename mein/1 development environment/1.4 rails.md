## 2.4 Ruby on Rails
Ruby on Rails — фреймворк, написанный на языке программирования Ruby. Ruby on Rails предоставляет архитектурный образец Model-View-Controller (модель-представление-контроллер) для веб-приложений, а также обеспечивает их интеграцию с веб-сервером и сервером базы данных
Ruby on Rails определяет следующие принципы разработки приложений:
* Предоставляет механизмы повторного использования, позволяющие минимизировать дублирование кода в приложениях (принцип Don’t repeat yourself).
* По умолчанию используются соглашения по конфигурации, типичные для большинства приложений (принцип Convention over configuration). Явная спецификация конфигурации требуется только в нестандартных случаях.

Вокруг Rails сложилась большая экосистема плагинов — подключаемых «гемов» (англ. gem), некоторые из них со временем были включены в базовую поставку Rails, например Sass и CoffeeScript, другие же, хотя и не были включены в базовую поставку, являются фактическим стандартом для большинства разработчиков, например, средство тестирования RSpec.
Начиная с 3-й версии Rails наблюдается тенденция вынесения части функционала в отдельные «гемы», отчасти из-за их более быстрого развития, чем сам Rails, отчасти для облегчения фреймворка.
Наиболее часто используемые гемы: Devise (для аутентификации), CanCan (для авторизации), Kaminari (для разделения записей, извлекаемых из базы данных, или элементов массива по страницам), Inherited Resources (для упрощения создания контроллеров со стандартным CRUD-кодом), FFaker (для случайной генерации тестовых наборов данных в веб-приложениях), friendly_id (позволяет создавать человеко-понятные веб-адреса), Active Admin (для создания панелей администрирования), CommunityEngine (для создания социальных сетей).
Ruby on Rails использовался при создании таких популярных сайтов, как Твиттер, GitHub, Diaspora, Look At Me, Groupon, Basecamp, Hulu, Scribd, Shopify, Yellowpages.com, Danbooru

### Архитектура
Основными компонентами приложений Ruby on Rails являются модель (англ. model), представление (англ. view) и контроллер (англ. controller). Вместе они формируют архитектуру MVC (Model-View-Controller). Ruby on Rails использует REST-стиль построения веб-приложений.
#### Модель
Модель предоставляет остальным компонентам приложения объектно-ориентированное отображение данных (таких как каталог продуктов или список заказов). Объекты модели могут осуществлять загрузку и сохранение данных в базе данных, а также реализуют бизнес-логику.
Для хранения объектов модели в реляционной СУБД по умолчанию в Rails использована библиотека ActiveRecord. Конкурирующий аналог — DataMapper. Существуют плагины для работы с нереляционными базами данных, например Mongoid для работы с MongoDB.

Если призадуматься, части MVC — представление и контроллер — тесно связаны друг с другом. Контроллер снабжает представление данными, и он же воспринимает события от страниц, сгенерированных представлениями. Из-за такого тесного взаимодействия поддержка представлений и контроллеров в Rails объединенав единый компонент — Action Pack.
Но не стоит думать, что в вашем приложении код представления и код контроллера будут перемешаны только потому, что Action Pack является единым компонентом. Все как раз наоборот, Rails предоставляет вам разделение, необходимое для создания приложений с четко разграниченным кодом для логики управления и представления.
#### Представление
Представление создает пользовательский интерфейс с использованием полученных от контроллера данных. Представление также передает запросы пользователя на манипуляцию данными в контроллер (как правило, представление не изменяет непосредственно модель).
Представление в Rails отвечает за создание полного или частичного ответа, отображаемого в браузере, обработанного приложением или посланного в виде электронной почты. В простейшем виде представление является фрагментом HTML-кода, отображающего какой-нибудь неизменный текст. Но чаще всего вам потребуется включить динамическое содержимое, созданное методом действия в контроллере.
Динамическое содержимое в Rails генерируется шаблонами трех видов. В самой распространенной схеме создания шаблонов, которая называется вcтроенным Ruby — Embedded Ruby (ERb), фрагменты кода Ruby вставляются в представляемый документ, что во многом похоже на способ, применяемый в других веб-средах, например в PHP или в JSP. При всей гибкости данного подхода, некоторые специалисты озабочены тем, что он нарушает сам смысл MVC. Вставляя код в представление, мы рискуем заложить в него логику, которая должна быть в модели или в контроллере. Как и во всем остальном, разумная умеренность будет полезной, а злоупотребление может превратиться в серьезную проблему. Соблюдение четкого разделения интересов является частью труда разработчика.
ERb можно также использовать для конструирования на сервере JavaScript-фрагментов, выполняемых в браузере. Эта технология отлично подходит для создания динамичных AJAX-интерфейсов.
В Rails также имеется такой инструмент, как XML Builder, позволяющий конструировать XML-документы, использующие код Ruby, — структура генерируемого XML будет автоматически следовать за структурой кода.

#### Контроллер
Контроллер в Rails — это набор логики, запускаемой после получения HTTP-запроса сервером. Контроллер отвечает за вызов методов модели и запускает формирование представления.
Он координирует взаимодействие между пользователем, представлениями и моделью. Но с большинством этих взаимодействий Rails справляется без вашего участия, а со­здаваемый вами код концентрируется на функциональности прикладного уровня. Это существенно упрощает разработку и поддержку кода Rails-контроллера.
Контроллер также является местом для нескольких важных вспомогательных служб:
* Он отвечает за перенаправление внешних запросов внутренним действиям. Он отлично справляется с удобными для человеческого восприятия URL-адресами.
* Он управляет кэшированием, ускоряющим работу приложения в несколько раз.
* Он управляет вспомогательными модулями, расширяющими возможности шаблонов представлений без увеличения объема их кода.
* Он управляет сессиями, дающими пользователям ощущение непрерывного взаимодействия с нашими приложениями.

Соответствие интернет-адреса с действием контроллера (маршрут) задается в файле ```config/routes.rb```.
Контроллером в Ruby on Rails является класс, наследованный от ```ActionController::Base```. Открытые методы контроллера являются так называемыми действиями (actions). Action часто соответствует отдельному представлению. Например, по запросу пользователя ```admin/list``` будет вызван метод ```list``` класса `AdminController` и затем использовано представление ```list.html.erb```.