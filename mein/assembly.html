<meta charset="UTF-8">
<h2>СОДЕРЖАНИЕ</h2>

<p>1 ВВЕДЕНИЕ <br>
2&nbsp;ОПИСАНИЕ СРЕДЫ РАЗРАБОТКИ <br>
2.2.Язык разметки гипертекста (HTML)<br>
2.2 Каскадные таблицы стилей (CSS)<br>
2.3 Язык программирования Ruby<br>
2.4&nbsp;Ruby on Rails<br>
2.5 Язык программирования JavaScript<br>
2.6 Heroku<br>
2.7 Шаблонизатор Slim<br>
2.8 Twitter Bootstrap<br>
3&nbsp;РАЗРАБОТКА САЙТА<br>
3.1 Установка Rails<br>
3.2 Создание нового приложения<br>
3.3 Создание БД<br>
3.4 Генерирование временной платформы<br>
3.5 Подключение плагинов<br>
3.6 Модели<br>
4 ЛИСТИНГ СТРАНИЦ ВЕБ-САЙТА<br>
4.1 Каталог заведений<br>
4.2 Заказы<br>
5 ЗАКЛЮЧЕНИЕ<br>
6 СПИСОК ИСПОЛЬЗОВАННОЙ ЛИТЕРАТУРЫ</p>

<h1>1 ВВЕДЕНИЕ</h1>

<p>Интернет – это всемирная система объединенных компьютерных сетей. Сегодня Интернет является одним из важнейших средств массовых коммуникаций. Эта мировая сеть по степени своей важности и значимости стоит рядом с телевидением, телефонной связью и прессой. Интернет представляет собой одно из главных средств общения, развлечения, торговли и рекламы. В Интернете можно найти практически все, что нужно любому человеку. Причем, не существует никаких территориальных или национальных ограничений для доступа к информации.<br>
Интернет является самым быстроразвивающимся средством вещания в истории человечества. Ничто не может подать информацию человеку в удобном, понятном, интересном представлении, как, например, веб–сайт. Сайт может содержать в себе текст, графику, звук, анимацию, видео.<br>
Однако перед пользователями все же зачастую возникает вопрос, где найти ту или иную интересующую их информацию на обширных просторах Интернета.<br>
Задача курсовой работы – создание веб-приложения, позволяющего пользователю бронировать места в ресторанах в режиме онлайн.<br>
Создание приложения будет осуществляться с помощью фреймворка Ruby on Rails.</p>

<h1>2&nbsp;ОПИСАНИЕ СРЕДЫ РАЗРАБОТКИ</h1>

<h2>2.1&nbsp;Язык разметки гипертекста (HTML)</h2>

<p>HTML (от англ. HyperText Markup Language – «язык разметки гипертекста») – стандартный язык разметки документов во Всемирной паутине. Большинство веб-страниц создаются при помощи языка HTML (или XHTML). Язык HTML интерпретируется браузерами и отображается в виде документа в удобной для человека форме.<br>
HTML является приложением (частным случаем) SGML (стандартного обобщённого языка разметки) и соответствует международному стандарту ISO 8879.<br>
HTML-документ представляет собой текстовый файл, содержащий собственно текст, который должен быть отображен в окне браузера, и команды разметки – HTML-тэги, определяющие внешний вид документа при его интерпретации в окне браузера.<br>
Браузер – программное обеспечение для просмотра веб-сайтов, то есть для запроса веб-страниц (преимущественно из Сети), их обработки, вывода и перехода от одной страницы к другой. Многие современные браузеры также могут загружать файлы с FTP-серверов.<br>
Документы в формате HTML обычно имеют расширение .html и записываются в текстовом формате, поэтому они могут быть созданы в любом текстовом редакторе. Форматирование документа осуществляется HTML-тэгами.<br>
HTML-тэг записывается в угловых скобках (&lt;&nbsp;&gt;) и состоит из имени, за которым может следовать список атрибутов (для большинства тэгов необязательный). Имена и атрибуты представляют собой английские слова и аббревиатуры и почти всегда их смысл прозрачен. Записывать тэги можно в любом регистре&nbsp;– прописными или строчными буквами.<br>
Тэги можно разделить на две большие группы: контейнеры и автономные тэги.<br>
Контейнеры воздействуют на часть документа, заключенную между ними. Они имеют два компонента: открывающий (начальный) и закрывающий (конечный). Закрывающий тэг имеет то же название, что и открывающий, но перед его названием ставится косая черта (символ /). Между открывающим и закрывающим тэгами могут располагаться текст или другие тэги.<br>
Автономные (одиночные) тэги не имеют конечного компонента. Они вызывают однократное действие или при их интерпретации в отображаемый документ вставляется тот или иной объект. Например, тэг <code>&lt;img src="pict.gif"&gt;</code><br>
вызывает вставку рисунка из файла pict.gif.<br>
Тэги могут иметь уточняющие параметры – атрибуты. Атрибуты записываются внутри автономного тэга, а в контейнере – только в открывающей части. В списке атрибуты отделяются друг от друга пробелами. Последовательность атрибутов не существенна. Значения атрибутов указываются после знака равенства в кавычках.<br>
Любой HTML-документ состоит из 3 частей:<br>
1.&nbsp;Объявление HTML.<br>
2.&nbsp;Заголовок.<br>
3.&nbsp;Тело документа.<br>
Объявление HTML производится тегом <code>&lt;html&gt;&nbsp;&lt;/html&gt;</code>. Тег <code>&lt;html&gt;</code> является контейнером, который заключает в себе все содержимое веб-страницы, включая теги <code>&lt;head&gt;</code> и <code>&lt;body&gt;</code>. Открывающий и закрывающий теги <code>&lt;html&gt;</code> в документе необязательны, но хороший стиль диктует непременное их использование.<br>
Заголовок представляет собой текст заключенный в теге <code>&lt;title&gt;&nbsp;&lt;/title&gt;</code>. Он определяет текст, который будет отображаться в заголовке браузера. Тег <code>&lt;head&gt;</code> предназначен для хранения других элементов, цель которых&nbsp;– помочь браузеру в работе с данными. Также внутри контейнера <code>&lt;head&gt;</code> находятся метатеги, которые используются для хранения информации предназначенной для браузеров и поисковых систем. Содержимое тега <code>&lt;head&gt;</code>, за исключением тега <code>&lt;title&gt;</code>,  не отображается напрямую на веб-странице.<br>
Тело документа представляет собой данные заключенные в теге <code>&lt;body&gt;&nbsp;&lt;/body&gt;</code>. Элемент <code>&lt;body&gt;</code> предназначен для хранения содержания веб-страницы (контента), отображаемого в окне браузера. Информацию, которую следует выводить в документе, располагается именно внутри контейнера <code>&lt;body&gt;</code>.</p>

<h2>2.2 Каскадные таблицы стилей (CSS)</h2>

<p>Cascading Style Sheets (CSS) – каскадные таблицы стилей. Таблицы стилей позволили отделить детали дизайна страницы от ее структуры и содержания. В первых версиях HTML структура и дизайн были вперемешку: рядом с текстовым абзацем его цвет, размер шрифта, цвет фона и т.п. Если мы захотим изменить такой простой параметр, как размер шрифта на своем сайте – придется переписывать все странички. CSS позволяет назначить всем объектам стиль, описание которого может храниться в отдельном файле. Используя CSS, мы можем изменить размер шрифта во всех страницах сайта, исправив только один файл с описанием стилей. <br>
CSS, или каскадные таблицы стилей, – это то, как HTML представлен. Точно также как HTML описывает контент, таблицы стилей определяют, как документ выглядит.<br>
Стили не напоминают структуру HTML. Они используют формат «свойство: значение» и большая часть свойств может использоваться для большинства HTML-тегов.</p>

<h3>Главные преимущества CSS:</h3>

<p>Повторное использование кода</p>

<ul class="task-list">
<li>Этот код легче поддерживать</li>
<li>Он быстрее загружается</li>
<li>Он лучше оптимизирован для поисковых систем</li>
</ul><p>Модульный код</p>

<ul class="task-list">
<li>Правила стиля могут применяться ко множеству страниц</li>
<li>Единообразный дизайн</li>
<li>Код легче поддерживать</li>
</ul><p>Сила дизайна</p>

<ul class="task-list">
<li>Точность контроля (позиционирование, размер, поля и др.)</li>
</ul><p>Разделение труда</p>

<ul class="task-list">
<li>Задача разработчика — разрабатывать, задача дизайнера — создавать дизайн</li>
</ul><p>Доступность</p>

<ul class="task-list">
<li>Теги больше не используются не по назначению (например, <code>&lt;blockquote&gt;</code> для форматирования)</li>
<li>Нет необходимости в позиционировании невидимых картинок</li>
<li>Пользователи могут переписывать стилевые таблицы автора</li>
</ul><h2>2.3 Язык программирования Ruby</h2>

<p>Создатель Ruby — японский разработчик Юкихиро Мацумото (Matz).<br>
Ruby — динамический, рефлективный, интерпретируемый высокоуровневый язык программирования для быстрого и удобного объектно-ориентированного программирования. Язык обладает независимой от операционной системы реализацией многопоточности, строгой динамической типизацией, сборщиком мусора и многими другими возможностями. Ruby близок по особенностям синтаксиса к языкам Perl и Eiffel, по объектно-ориентированному подходу — к Smalltalk. Также некоторые черты языка взяты из Python, Lisp, Dylan и Клу.</p>

<p>Кроссплатформенная реализация интерпретатора языка является полностью свободной.</p>

<h3>Философия</h3>

<p>Мацумото, фанат объектно-ориентированного программирования, мечтал о языке, более мощном, чем Perl, и более объектно-ориентированном, чем Python. Основное назначение Ruby — создание простых и в то же время понятных программ, где важна не скорость работы программы, а малое время разработки, понятность и простота синтаксиса.<br>
Язык следует принципу «наименьшей неожиданности»: программа должна вести себя так, как ожидает программист. Однако в контексте Ruby это означает наименьшее удивление не при знакомстве с языком, а при его основательном изучении. Сам Мацумото утверждает, что целью разработки была минимизация неожиданностей при программировании для него, но после распространения языка он с удивлением узнал, что мышление программистов похоже, и для многих из них принцип «наименьшей неожиданности» совпал с его принципом.<br>
Ruby также унаследовал идеологию языка программирования Perl в части предоставления программисту возможностей достижения одного и того же результата несколькими различными способами. Люди различны, и им для свободы необходима возможность выбирать. «Я предпочитаю обеспечить много путей, если это возможно, но поощрять или вести пользователей, чтобы выбрать лучший путь, если это возможно».<br>
Одной из основных целей разработки было освобождение программистов от рутинной работы, которую вычислитель может выполнять быстрее и качественнее. Особое внимание, в частности, уделялось будничным рутинным занятиям (обработка текстов, администрирование), и для них язык настроен особенно хорошо.<br>
В противовес машинно-ориентированным языкам, работающим быстрее, целью этой разработки был язык, наиболее близкий к человеку. Любая работа с компьютером выполняется людьми и для людей, и необходимо заботиться в первую очередь о затрачиваемых усилиях людей. Язык позволяет максимально быстро и просто для человека выполнить задачу, хотя, возможно, это и потребует дополнительного времени работы компьютера. На пороге технологической сингулярности, машинное время невероятно дешево. Так стоит ли тратить время человека на перекладывание байтов?<br>
Принципы программирования и устройства языка иногда выделяются в термин «Путь Ruby» (англ. Ruby Way). Хэл Фултон выделяет такие принципы, как «просто, но не слишком просто», «принцип наименьшего удивления», вторичность скорости работы программы, динамичность, простые строгие правила, выполнение которых не доходит до педантизма, потребность создавать полезные и красивые программы как причина программирования. В целом они не имеют точной формулировки и иногда этот термин используется для критики.</p>

<h3>Возможности Ruby</h3>

<p>Интерпретируемый язык:</p>

<ul class="task-list">
<li>Возможность прямых системных вызовов.</li>
<li>Мощная поддержка операций со строками и правилами (регулярными выражениями).</li>
<li>Мгновенное проявление изменений во время разработки.</li>
<li>Отсутствие стадии компиляции.</li>
</ul><p>Простое и быстрое программирование:</p>

<ul class="task-list">
<li>Не надо объявлять переменные.</li>
<li>Переменные динамически типизированы.</li>
<li>Простой и последовательный синтаксис.</li>
<li>Автоматическое управление памятью.</li>
</ul><p>Объектно-ориентированное программирование:</p>

<ul class="task-list">
<li>Всё есть объект. Даже имя класса - это экземпляр класса Class.</li>
<li>Классы, методы, наследование, полиморфизм, инкапсуляция и так далее.</li>
<li>Методы-одиночки.</li>
<li>Примеси (mixins) при помощи модулей (возможность расширить класс без наследования);</li>
<li>Итераторы и замыкания.</li>
<li>Широкие возможности метапрограммирования.</li>
</ul><p>Удобства:</p>

<ul class="task-list">
<li>Неограниченный диапазон значений целых чисел.</li>
<li>Все операторы и управляющие структуры являются методами и возвращают значение.</li>
<li>Динамическая загрузка.</li>
<li>Механизм перехвата исключений.</li>
<li>Поддержка потоков; как собственных, так и систем семейства UNIX.</li>
</ul><p>Недостатки:</p>

<ul class="task-list">
<li>Неуправляемость некоторых процессов (таких, как выделение памяти), невозможность задания низкоуровневых структур данных или подпрограмм;</li>
<li>Невозможность компиляции и сопутствующей ей оптимизации программы;</li>
<li>Открытость исходного кода даже в готовой программе (есть средство упаковки исходного кода в .exe-файл под Windows);</li>
<li>Следствие двух первых недостатков — весьма низкая скорость запуска и выполнения программ.</li>
<li>Не так уж и часто, но все же бывает, что документация только на японском.</li>
</ul><h3>Примеры</h3>

<p>Ruby — полностью объектно-ориентированный язык. В нём все данные являются объектами, в отличие от многих других языков, где существуют примитивные типы. Каждая функция — метод. Даже ключевые слова - всего лишь синтаксический сахар для методов.<br>
В Ruby есть немало оригинальных решений, редко или вообще не встречающихся в распространённых языках программирования. Можно добавлять методы не только в любые классы, но и в любые объекты. Например, вы можете добавить к некоторой строке произвольный метод.</p>

<div class="highlight highlight-ruby"><pre>                   <span class="c1"># всё от символа # и до конца строки - комментарий</span>
                   <span class="c1"># = является оператором присваивания,</span>
                   <span class="c1"># символы в «"» - строка, которой можно манипулировать средствами языка</span>
  <span class="n">str</span> <span class="o">=</span> <span class="s2">"Привет"</span>   <span class="c1"># здесь создаётся переменная str, типа String</span>
                   <span class="c1"># def - ключевое слово для объявления функции</span>
  <span class="k">def</span> <span class="nc">str</span><span class="o">.</span><span class="nf">bye</span>      <span class="c1"># str. указывает, кому принадлежит метод (по умолчанию Object)</span>
                   <span class="c1"># bye - имя метода, за ним может следовать необязательный, заключённый в</span>
                   <span class="c1"># круглые скобки список параметров функции</span>
    <span class="s2">"Пока!"</span>        <span class="c1"># из метода возвращается последнее вычисленное значение (здесь - строка)</span>
  <span class="k">end</span>              <span class="c1"># ключевым словом end заканчиваются практически все инструкции Ruby</span>
                   <span class="c1"># puts - метод,</span>
                   <span class="c1"># str.bye - обращение к методу bye объекта str</span>
                   <span class="c1"># значение, полученное из метода bye передаётся методу puts</span>
                   <span class="c1"># который выводит на экран информацию</span>
  <span class="nb">puts</span> <span class="n">str</span><span class="o">.</span><span class="n">bye</span>     <span class="c1">#=&gt; Пока!</span>
</pre></div>

<p>Работа с массивами — одна из сильных сторон Ruby. Они автоматически изменяют размер, могут содержать любые элементы, а язык предоставляет мощные средства для их обработки.</p>

<div class="highlight highlight-ruby"><pre>                          <span class="c1"># создаём массив</span>
 <span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'hi'</span><span class="p">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="o">]</span> <span class="o">*</span> <span class="mi">3</span><span class="o">]</span>
                           <span class="c1"># =&gt; [1, "hi", 3.14, 1, 2, [4, 5, 4, 5, 4, 5]]</span>

                           <span class="c1"># обращение по индексу</span>
 <span class="n">a</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>                      <span class="c1"># =&gt; 3.14</span>

                           <span class="c1"># «разворачиваем» все внутренние массивы, удаляем одинаковые элементы</span>
 <span class="n">a</span><span class="o">.</span><span class="n">flatten</span><span class="o">.</span><span class="n">uniq</span>            <span class="c1"># =&gt; [1, 'hi', 3.14, 2, 4, 5]</span>

                           <span class="c1"># пытаемся найти индекс элемента со значением 6</span>
 <span class="n">a</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>                <span class="c1"># =&gt; nil</span>
                           <span class="c1"># неудача: возвращается значение nil</span>

                           <span class="c1"># почти для всех функций предоставляется</span>
                           <span class="c1"># аналог с тем же названием, но заканчивающийся на «!»,</span>
                           <span class="c1"># который модифицирует контейнер</span>
 <span class="n">a</span><span class="o">.</span><span class="n">flatten!</span>                <span class="c1"># =&gt; [1, "hi", 3.14, 1, 2, 4, 5, 4, 5, 4, 5]</span>

                           <span class="c1"># находим индекс первого элемента со значением 4</span>
 <span class="n">a</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                <span class="c1"># =&gt; 5</span>
</pre></div>

<p>Следующий пример определяет класс с именем Person, предназначенный для хранения информации об имени и возрасте некоторой персоны.</p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">Object</span>       <span class="c1"># объявление класса начинается с ключевого слова class, за которым</span>
                             <span class="c1"># следует имя, класс Person наследуется от Object</span>
   <span class="kp">include</span> <span class="no">Comparable</span>        <span class="c1"># подмешиваются к классу методы экземпляра</span>
                             <span class="c1"># и добавляет методы &lt;, &lt;=, ==, &gt;=, &gt; и between?</span>
                             <span class="c1"># с использованием нижеопределённого</span>
                             <span class="c1"># в классе &lt;=&gt;</span>

   <span class="vi">@variable</span>                 <span class="c1"># переменная экземпляра</span>
   <span class="vc">@@count_obj</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># переменная класса для подсчёта числа созданных объектов</span>

                             <span class="c1"># конструктор для создания объектов с помощью new</span>
   <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="c1"># name, age - параметры метода</span>
                             <span class="c1"># название переменных объекта начинается с @</span>
     <span class="vi">@name</span><span class="p">,</span> <span class="vi">@age</span> <span class="o">=</span> <span class="nb">name</span><span class="p">,</span> <span class="n">age</span> <span class="c1"># создаём объекты и увеличиваем счётчик на 1</span>
     <span class="vc">@@count_obj</span> <span class="o">+=</span> <span class="mi">1</span>
   <span class="k">end</span>

   <span class="k">def</span> <span class="nf">&lt;=&gt;</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>           <span class="c1"># переопределение оператора &lt;=&gt; (spaceship) </span>
                             <span class="c1"># (это даёт возможность использовать метод sort)</span>
     <span class="vi">@age</span> <span class="o">&lt;=&gt;</span> <span class="n">person</span><span class="o">.</span><span class="n">age</span>     <span class="c1"># из метода возвращается последнее вычисленное выражение,</span>
   <span class="k">end</span>

   <span class="k">def</span> <span class="nf">to_s</span>                  <span class="c1"># для форматированного вывода информации puts</span>
     <span class="s2">"</span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> (</span><span class="si">#{</span><span class="vi">@age</span><span class="si">}</span><span class="s2">)"</span>    <span class="c1"># конструкция #{x} в 2-х кавычках замещается в Ruby значением x</span>
   <span class="k">end</span>

   <span class="k">def</span> <span class="nf">inspect</span>               <span class="c1"># похож на to_s, но используется для диагностического вывода</span>
     <span class="s2">"&lt;</span><span class="si">#{</span><span class="vc">@@count_obj</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="nb">to_s</span><span class="si">}</span><span class="s2">&gt;"</span>
   <span class="k">end</span>
                             <span class="c1"># пример метапрограммирования: добавляет геттеры для доступа к</span>
                             <span class="c1"># переменным объекта</span>
   <span class="kp">attr_reader</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span>
 <span class="k">end</span>
                             <span class="c1"># создаём массив объектов</span>
 <span class="n">group</span> <span class="o">=</span> <span class="o">[</span> <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">"John"</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
          <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">"Markus"</span><span class="p">,</span> <span class="mi">63</span><span class="p">),</span>
          <span class="no">Person</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">"Ash"</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">]</span>
                      <span class="c1"># =&gt; [&lt;3:John (20)&gt;, &lt;3:Markus (63)&gt;, &lt;3:Ash (16)&gt;]</span>
                      <span class="c1"># здесь при работе с irb автоматически вызывается метод inspect</span>
                      <span class="c1"># вызываем методы массива сортировка и разворачивание его в обратном порядке</span>
 <span class="nb">puts</span> <span class="n">group</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">reverse</span> <span class="c1"># Печатает:</span>
                         <span class="c1"># Markus (63)</span>
                         <span class="c1"># John (20)</span>
                         <span class="c1"># Ash (16)</span>
                                    <span class="c1"># обращаемся к функции, которая была добавлена</span>
                                    <span class="c1"># автоматически(используя &lt;=&gt;) при включении Comparable</span>
 <span class="n">group</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">between?</span><span class="p">(</span><span class="n">group</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span> <span class="n">group</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span> <span class="c1"># =&gt; true</span>
</pre></div>

<h3>Приминение</h3>

<p>Ruby используется в NASA, NOAA (национальная администрация по океану и атмосфере), Motorola и других крупных организациях. Следующие программы используют Ruby как скриптовый язык для расширения возможностей программы или написаны на нём (частично или полностью).</p>

<ul class="task-list">
<li>RPG Maker (RPG Maker XP) — RGSS (Ruby Game Scripting System)</li>
<li>Amarok</li>
<li>SketchUp</li>
<li>Inkscape — скрипты для обработки векторных изображений</li>
<li>Metasploit</li>
<li>Chef, Puppet — системы управления конфигурациями</li>
<li>Redmine — багтрекер</li>
<li>XChat</li>
<li>WATIR (англ. Web Application Testing in Ruby) — свободное средство для автоматического тестирования веб-приложений в браузере.</li>
<li>Puppet</li>
</ul><h2>2.4 Ruby on Rails</h2>

<p>Ruby on Rails — фреймворк, написанный на языке программирования Ruby. Ruby on Rails предоставляет архитектурный образец Model-View-Controller (модель-представление-контроллер) для веб-приложений, а также обеспечивает их интеграцию с веб-сервером и сервером базы данных<br>
Ruby on Rails определяет следующие принципы разработки приложений:</p>

<ul class="task-list">
<li>Предоставляет механизмы повторного использования, позволяющие минимизировать дублирование кода в приложениях (принцип Don’t repeat yourself).</li>
<li>По умолчанию используются соглашения по конфигурации, типичные для большинства приложений (принцип Convention over configuration). Явная спецификация конфигурации требуется только в нестандартных случаях.</li>
</ul><p>Вокруг Rails сложилась большая экосистема плагинов — подключаемых «гемов» (англ. gem), некоторые из них со временем были включены в базовую поставку Rails, например Sass и CoffeeScript, другие же, хотя и не были включены в базовую поставку, являются фактическим стандартом для большинства разработчиков, например, средство тестирования RSpec.<br>
Начиная с 3-й версии Rails наблюдается тенденция вынесения части функционала в отдельные «гемы», отчасти из-за их более быстрого развития, чем сам Rails, отчасти для облегчения фреймворка.<br>
Наиболее часто используемые гемы: Devise (для аутентификации), CanCan (для авторизации), Kaminari (для разделения записей, извлекаемых из базы данных, или элементов массива по страницам), Inherited Resources (для упрощения создания контроллеров со стандартным CRUD-кодом), FFaker (для случайной генерации тестовых наборов данных в веб-приложениях), friendly_id (позволяет создавать человеко-понятные веб-адреса), Active Admin (для создания панелей администрирования), CommunityEngine (для создания социальных сетей).<br>
Ruby on Rails использовался при создании таких популярных сайтов, как Твиттер, GitHub, Diaspora, Look At Me, Groupon, Basecamp, Hulu, Scribd, Shopify, Yellowpages.com, Danbooru</p>

<h3>Архитектура</h3>

<p>Основными компонентами приложений Ruby on Rails являются модель (англ. model), представление (англ. view) и контроллер (англ. controller). Вместе они формируют архитектуру MVC (Model-View-Controller). Ruby on Rails использует REST-стиль построения веб-приложений.</p>

<h4>Модель</h4>

<p>Модель предоставляет остальным компонентам приложения объектно-ориентированное отображение данных (таких как каталог продуктов или список заказов). Объекты модели могут осуществлять загрузку и сохранение данных в базе данных, а также реализуют бизнес-логику.<br>
Для хранения объектов модели в реляционной СУБД по умолчанию в Rails использована библиотека ActiveRecord. Конкурирующий аналог — DataMapper. Существуют плагины для работы с нереляционными базами данных, например Mongoid для работы с MongoDB.</p>

<p>Если призадуматься, части MVC — представление и контроллер — тесно связаны друг с другом. Контроллер снабжает представление данными, и он же воспринимает события от страниц, сгенерированных представлениями. Из-за такого тесного взаимодействия поддержка представлений и контроллеров в Rails объединенав единый компонент — Action Pack.<br>
Но не стоит думать, что в вашем приложении код представления и код контроллера будут перемешаны только потому, что Action Pack является единым компонентом. Все как раз наоборот, Rails предоставляет вам разделение, необходимое для создания приложений с четко разграниченным кодом для логики управления и представления.</p>

<h4>Представление</h4>

<p>Представление создает пользовательский интерфейс с использованием полученных от контроллера данных. Представление также передает запросы пользователя на манипуляцию данными в контроллер (как правило, представление не изменяет непосредственно модель).<br>
Представление в Rails отвечает за создание полного или частичного ответа, отображаемого в браузере, обработанного приложением или посланного в виде электронной почты. В простейшем виде представление является фрагментом HTML-кода, отображающего какой-нибудь неизменный текст. Но чаще всего вам потребуется включить динамическое содержимое, созданное методом действия в контроллере.<br>
Динамическое содержимое в Rails генерируется шаблонами трех видов. В самой распространенной схеме создания шаблонов, которая называется вcтроенным Ruby — Embedded Ruby (ERb), фрагменты кода Ruby вставляются в представляемый документ, что во многом похоже на способ, применяемый в других веб-средах, например в PHP или в JSP. При всей гибкости данного подхода, некоторые специалисты озабочены тем, что он нарушает сам смысл MVC. Вставляя код в представление, мы рискуем заложить в него логику, которая должна быть в модели или в контроллере. Как и во всем остальном, разумная умеренность будет полезной, а злоупотребление может превратиться в серьезную проблему. Соблюдение четкого разделения интересов является частью труда разработчика.<br>
ERb можно также использовать для конструирования на сервере JavaScript-фрагментов, выполняемых в браузере. Эта технология отлично подходит для создания динамичных AJAX-интерфейсов.<br>
В Rails также имеется такой инструмент, как XML Builder, позволяющий конструировать XML-документы, использующие код Ruby, — структура генерируемого XML будет автоматически следовать за структурой кода.</p>

<h4>Контроллер</h4>

<p>Контроллер в Rails — это набор логики, запускаемой после получения HTTP-запроса сервером. Контроллер отвечает за вызов методов модели и запускает формирование представления.<br>
Он координирует взаимодействие между пользователем, представлениями и моделью. Но с большинством этих взаимодействий Rails справляется без вашего участия, а со­здаваемый вами код концентрируется на функциональности прикладного уровня. Это существенно упрощает разработку и поддержку кода Rails-контроллера.<br>
Контроллер также является местом для нескольких важных вспомогательных служб:</p>

<ul class="task-list">
<li>Он отвечает за перенаправление внешних запросов внутренним действиям. Он отлично справляется с удобными для человеческого восприятия URL-адресами.</li>
<li>Он управляет кэшированием, ускоряющим работу приложения в несколько раз.</li>
<li>Он управляет вспомогательными модулями, расширяющими возможности шаблонов представлений без увеличения объема их кода.</li>
<li>Он управляет сессиями, дающими пользователям ощущение непрерывного взаимодействия с нашими приложениями.</li>
</ul><p>Соответствие интернет-адреса с действием контроллера (маршрут) задается в файле <code>config/routes.rb</code>.<br>
Контроллером в Ruby on Rails является класс, наследованный от <code>ActionController::Base</code>. Открытые методы контроллера являются так называемыми действиями (actions). Action часто соответствует отдельному представлению. Например, по запросу пользователя <code>admin/list</code> будет вызван метод <code>list</code> класса <code>AdminController</code> и затем использовано представление <code>list.html.erb</code>.</p>

<h2>2.5 Язык программирования JavaScript</h2>

<p>JavaScript – прототипно-ориентированный сценарный язык программирования. Является диалектом ECMAScript.<br>
JavaScript обычно используется как встраиваемый язык для программного доступа к объектам приложений. Наиболее широкое применение находит в браузерах как язык сценариев для придания интерактивности веб-страницам.<br>
Используемое в языке прототипирование обуславливает отличия в работе с объектами по сравнению с традиционными объектно-ориентированными языками. Кроме того, JavaScript имеет ряд свойств, присущих функциональным языкам – функции как объекты первого класса, объекты как списки, каррирование, анонимные функции, замыкания – что придаёт языку дополнительную гибкость.<br>
Несмотря на схожий с Си синтаксис, JavaScript по сравнению с языком Си имеет коренные отличия:</p>

<ul class="task-list">
<li>объекты, с возможностью интроспекции;</li>
<li>функции как объекты первого класса;</li>
<li>автоматическое приведение типов;</li>
<li>автоматическая сборка мусора;</li>
<li>анонимные функции.
Синтаксис языка JavaScript во многом напоминает синтаксис Си и Java.
В JavaScript:</li>
<li>все идентификаторы регистрозависимы,</li>
<li>в названиях переменных можно использовать буквы, подчёркивание, символ доллара, арабские цифры,</li>
<li>названия переменных не могут начинаться с цифры,</li>
<li>для оформления однострочных комментариев используются //, многострочные и внутристрочные комментарии начинаются с /* и заканчиваются */.</li>
</ul><p>Для добавления JavaScript-кода на страницу, можно использовать теги <code>&lt;script&gt; &lt;/script&gt;</code>, которые рекомендуется, но не обязательно, помещать внутри контейнера <code>&lt;head&gt;</code>. Контейнеров <code>&lt;script&gt;</code> в одном документе может быть сколько угодно. Атрибут <code>type='text/javascript'</code> указывать необязательно, так как по умолчанию стоит javascript.<br>
Также тег <code>&lt;script&gt;</code> можно располагать внутри других HTML тэгов.<br>
Код, написанный на JavaScript, будет корректно работать, только если в браузере есть и включена поддержка JavaScript.<br>
Использование кода JavaScript в контексте разметки страницы в рамках ненавязчивого JavaScript расценивается как плохая практика.<br>
Есть возможность подключения JavaScript в отдельном файле с помощью конструкции:<br><code>&lt;script type="text/javascript" src="http://Путь_к_файлу_со_скриптом"&gt;&lt;/script&gt;</code></p>

<h3>jQuery</h3>

<p>Джон Резиг (англ. John Resig) — разработчик в Академии Хана. В прошлом — JavaScript-евангелист в Mozilla Corporation. Именно он сделал $ оператором JavaScript.<br>
jQuery — библиотека JavaScript, фокусирующаяся на взаимодействии JavaScript и HTML. Библиотека jQuery помогает легко получать доступ к любому элементу DOM, обращаться к атрибутам и содержимому элементов DOM, манипулировать ими. Также библиотека jQuery предоставляет удобный API для работы с AJAX.<br>
Библиотека jQuery содержит функциональность, полезную для максимально широкого круга задач. Тем не менее, разработчиками библиотеки не ставилась задача совмещения в jQuery функций, которые подошли бы всюду, поскольку это привело бы к большому коду, бо́льшая часть которого не востребована. Поэтому была реализована архитектура компактного универсального ядра библиотеки и плагинов. Это позволяет собрать для ресурса именно ту JavaScript-функциональность, которая на нём была бы востребована.<br>
Возможности</p>

<ul class="task-list">
<li>Движок кроссбраузерных CSS-селекторов Sizzle, выделившийся в отдельный проект;</li>
<li>Переход по дереву DOM, включая поддержку XPath как плагина;</li>
<li>События;</li>
<li>Визуальные эффекты;</li>
<li>AJAX-дополнения;</li>
<li>JavaScript-плагины.</li>
<li>Кроссбраузерность.</li>
</ul><h4>Использование</h4>

<p>jQuery, как правило, включается в веб-страницу как один внешний JavaScript-файл:</p>

<pre><code>&lt;head&gt;
    &lt;script type="text/javascript" src="путь к jQuery.js"&gt;&lt;/script&gt;
&lt;/head&gt;
</code></pre>

<p>Предпочтительно загружать файл из CDN (англ. content delivery network). Большая вероятность, что другой сайт использовал этот же файл и он остался закэшированным в браузере пользователя.<br>
Работу с jQuery можно разделить на 2 типа:</p>

<ul class="task-list">
<li>Получение jQuery-объекта с помощью функции $(). Например, передав в неё CSS-селектор, можно получить jQuery-объект всех элементов HTML, попадающих под критерий и далее работать с ними с помощью различных методов jQuery-объекта. В случае, если метод не должен возвращать какого-либо значения, он возвращает ссылку на jQuery объект, что позволяет вести цепочку вызовов методов согласно концепции текучего интерфейса.</li>
<li>Вызов глобальных методов у объекта $, например, удобных итераторов по массиву.</li>
</ul><p>Типичный пример манипуляции сразу несколькими узлами DOM заключается в вызове $ функции со строкой селектора CSS, что возвращает объект jQuery, содержащий некоторое количество элементов HTML-страницы. Эти элементы затем обрабатываются методами jQuery. Например:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">(</span><span class="s2">"div.test"</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s2">"p.quote"</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">"blue"</span><span class="p">).</span><span class="nx">slideDown</span><span class="p">(</span><span class="s2">"slow"</span><span class="p">);</span>
</pre></div>

<p>находит все элементы div с классом test, а также все элементы p с классом quote, и затем добавляет им всем класс blue и визуально плавно спускает вниз. Здесь методы add, addClass и slideDown возвращают ссылку на исходный объект <code>$("div.test")</code>, поэтому возможно вести такую цепочку.<br>
В этом примере идет обращение к скрипту some.php с параметрами name=John&amp;location=Boston, и полученный результат выдается в сообщении посредством alert().</p>

<div class="highlight highlight-js"><pre><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
  <span class="nx">type</span><span class="o">:</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s2">"some.php"</span><span class="p">,</span>
  <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'John'</span><span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s1">'Boston'</span><span class="p">},</span>
  <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">){</span>
    <span class="nx">alert</span><span class="p">(</span> <span class="s2">"Data Saved: "</span> <span class="o">+</span> <span class="nx">msg</span> <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h2>2.6 Heroku</h2>

<p>Heroku - облачная PaaS-платформа (Platform-as-a-Service), поддерживающая ряд языков программирования. Heroku, одна из первых облачных платформ, появилась в июне 2007 года и изначально поддерживала только язык программирования Ruby, но на данный момент список поддерживаемых языков включает в себя Java, Node.js, Scala, Clojure, Python и PHP. На серверах Heroku используются операционные системы Debian или Ubuntu. Позволяет разработчику удобно и даже бесплатно (конечно, с ограничениями) разместить, масшатбировать и управлять приложениями без необходимости заботится о сервере и системном администрировании. В настоящий момент на Heroku размещено более миллиона приложений.</p>

<p>Достоинства:</p>

<ul class="task-list">
<li>облако - не нужно заботиться о машине. Платишь только за те ресурсы, которые используешь</li>
<li>заточено под Rails.</li>
<li>хорошая скорость доступа</li>
<li>есть бесплатный тариф</li>
<li>множество расширений</li>
<li>удобный клиент</li>
<li>развертывание приложения представляет собой размещение его в удаленный git-репозиторий</li>
</ul><p>Недостатки:</p>

<ul class="task-list">
<li>дорого</li>
<li>слабая документация. Если что-то происходит не по инструкции, то приходится читать форумы</li>
<li>нет родной поддержки MySql. Либо мигрируй на PostgreSQL, либо плати от $25 за Amazon RDS</li>
</ul><h2>2.7 Шаблонизатор Slim</h2>

<p>Slim - язык шаблонов, чья задача — сократить объем кода, при этом не делая его страшным и непонятным.<br>
Вот так выгядит шаблон с использованием Slim:</p>

<pre><code>doctype html
html
  head
    title Slim Examples
    meta name="keywords" content="template language"

  body
    h1 Markup examples
    #content.example1
      p Nest by indentation

    = yield

    - unless items.empty?
      table
        - for item in items do
          tr
            td = item.name
            td = item.price
    - else
      p No items found

    #footer
      | Copyright © 2010 Andrew Stone

    = render 'tracking_code'

    script
      | $(content).do_something();
</code></pre>

<h3>Список всех операторов:</h3>

<pre><code>| Вертикальная черта сообщает шаблонизатору, что нужно просто откопировать линию. При этом все "опасные" символы фильтруется.
' Одиночная скобка работает как и предыдущий оператор, но добавляет в конце пробел.
- Дефис работает как и в Haml, используется для циклов, условий и прочего, в чем вы раньше использовали &lt;% ... %&gt;
= Знак равенства работает как &lt;%= ... %&gt;, выводя содержимое в html
=' Работает как и предыдущий оператор, при этом добавляя в конец пробел.
== Работает как и знак равенства, но выводит текст "как есть", без обработки методом escape_html
==' Тоже самое, что и выше, но добавляет в конце пробел.
/ Знак комментария. Код не будет выполнен и не попадет в html вообще.
/! Знак для html комментариев (&lt;!-- --&gt;), которые попадут в вывод.
</code></pre>

<h3>Атрибуты и комментарии</h3>

<p>Обозначать id и class можно вот так:</p>

<pre><code>blockquote id="quote-#{@quote.id}" class="quote"
  p class="title" = @quote.title
  p style="padding:1em;" = @quote.body
</code></pre>

<p>Кроме того, Slim допускает несколько вариантов синтаксиса::</p>

<pre><code>/ Эти две линии идентичны.
#nav.top
div id="nav" class="top"

/ Допускается писать любой из этих вариантов
h1 class=page_header_class = page_header
h1{class=page_header_class} = page_header
h1[class=page_header_class] = page_header
h1(class=page_header_class) = page_header
</code></pre>

<p>Еще одна приятная штука — если в атрибуте не указаны кавычки, будет использована переменная. Из примера парой строчек выше можно увидеть, что используется переменная page_header_class.</p>

<pre><code># Можно писать и так, и так.
a href="#{url_for @user}" = @user.name
# Во втором случае не надо писать конструкцию "#{...}"
a href=url_for(@user) = @user.name
</code></pre>

<p>Если функция возвращает false, атрибут вообще не будет выведен в html:</p>

<pre><code>option value="Slim" selected=option_selected?("Slim") # -&gt; &lt;option value="Slim"&gt;&lt;/option&gt;
</code></pre>

<p>Можно использовать интерполяцию как в строках Ruby:</p>

<pre><code>body
  h1 Приветствуем, #{current_user.name}
  | С помощью двойных скобок #{{content}} выводится как есть, без фильтрации методом escape_html.
</code></pre>

<p>Мне очень нравится, как работают комментарии. Если у нас имеется блок кода, который надо закомментить, достаточно добавить всего одну строку, которая повлияет на весь блок.</p>

<pre><code># весь этот блок ниже закомментирован и не будет выведен
/.comments
  - @comments.each do |comment|
    == render comment
</code></pre>

<p>Стоит учесть, что метод render по-умолчанию фильтрует вывод, поэтому перед ним надо ставить двойной знак равенства, чтобы escape_html не сработал дважды.</p>

<h3>Производительность</h3>

<p>Шаблоны в Rails кешируются, поэтому по скорости они будут отставать от стандартного Erb лишь при первом обращении к ним. Вот сравнительная таблица, которая показывает, что Slim уж точно не будет узким местом:</p>

<pre><code># Linux + Ruby 1.9.2, 1000 iterations
                      user     system      total        real
(1) erb           0.680000   0.000000   0.680000 (  0.810375)
(1) erubis        0.510000   0.000000   0.510000 (  0.547548)
(1) fast erubis   0.530000   0.000000   0.530000 (  0.583134)
(1) slim          4.330000   0.020000   4.350000 (  4.495633)
(1) haml          4.680000   0.020000   4.700000 (  4.747019)
(1) haml ugly     4.530000   0.020000   4.550000 (  4.592425)

(2) erb           0.240000   0.000000   0.240000 (  0.235896)
(2) erubis        0.180000   0.000000   0.180000 (  0.185349)
(2) fast erubis   0.150000   0.000000   0.150000 (  0.154970)
(2) slim          0.050000   0.000000   0.050000 (  0.046685)
(2) haml          0.490000   0.000000   0.490000 (  0.497864)
(2) haml ugly     0.420000   0.000000   0.420000 (  0.428596)

(3) erb           0.030000   0.000000   0.030000 (  0.033979)
(3) erubis        0.030000   0.000000   0.030000 (  0.030705)
(3) fast erubis   0.040000   0.000000   0.040000 (  0.035229)
(3) slim          0.040000   0.000000   0.040000 (  0.036249)
(3) haml          0.160000   0.000000   0.160000 (  0.165024)
(3) haml ugly     0.150000   0.000000   0.150000 (  0.146130)

(4) erb           0.060000   0.000000   0.060000 (  0.059847)
(4) erubis        0.040000   0.000000   0.040000 (  0.040770)
(4) slim          0.040000   0.000000   0.040000 (  0.047389)
(4) haml          0.190000   0.000000   0.190000 (  0.188837)
(4) haml ugly     0.170000   0.000000   0.170000 (  0.175378)

1. Рендер некешированной страницы при первом обращении.
   Его можно активировать, используя параметр slow=1.

2. Кешированный тест. Шаблон предварительно парсится.
   Код Ruby не компилируется и может быть выполнен в любое время.
   Этот бенчмарк испольует стандартное API шаблонов.

3. Компилированный тест. Шаблон также предварительно парсится,
   но кроме того, код Ruby компилируется в отдельный метод.
   Это самый быстрый тест, потому что в нем тестируется лишь
   скорость выполнения самого кода.

4. Компилированный Tilt-бенчмарк. Шаблон компилируется с помощью Tilt,
   что даёт более точные результаты производительности в режиме Продакшена
   в таких фреймворках как Sinatra, Ramaze and Camping.
</code></pre>

<h2>2.8 Twitter Bootstrap</h2>

<p>Twitter Bootstrap является невероятно популярным front-end фреймворком, который используют многие дизайнеры, разработчики и компании. Он с открытым исходным кодом, прост в использовании, адаптивный, кросс-браузерный (по утверждению разработчиков он совместим даже с IE7). Как и для всех популярных фреймворков существует множество готовых тем.<br>
Bootstrap вкючает в себя HTML и CSS шаблоны оформления для типографики, веб-форм, кнопок, меток, блоков навигации и прочих компонентов веб-интерфейсов, включая JavaScript расширения. Bootstrap использует самые современные наработки в области CSS и HTML, поэтому необходимо быть внимательным при поддержке старых браузеров.<br>
Основные особенности Bootstrap:</p>

<ul class="task-list">
<li>Сетки — заранее заданные размеры колонок, которые можно сразу же использовать, например ширина колонки 25% относится к классу .col-md-3, который можно использовать в CSS описании документа.</li>
<li>Шаблоны — Фиксированный или резиновый шаблон документа.</li>
<li>Типографика — Описания шрифтов, определение некоторых классов для шрифтов таких как код, цитаты и т. п.</li>
<li>Медиа — Представляет некоторое управление изображениями и Видео.</li>
<li>Таблицы — Средства оформления таблиц, вплоть до добавления функциональности сортировки.</li>
<li>Формы — Классы для оформления не только форм, но и некоторых событий происходящих с ними.</li>
<li>Навигация — Классы оформления для Табов, Вкладок, Страничности, Меню и Тулбара.</li>
<li>Алерты — Оформление диалоговых окон, Подсказок и Всплывающих окон.</li>
<li>Начиная со второй версии поддерживает адаптивный дизайн. Это значит, что при отображении страницы учитывается размер экрана используемого устройста.</li>
<li>Документация переводится сообществом на другие языки. Уже доступна документация на испанском, китайском и русском языках.</li>
</ul><h3>Использование</h3>

<p>Чтобы использовать Bootstrap в HTML странице, нужно зарузить таблицу стилей Bootstrap и добавить ссылку на них в HTML файле. <br>
В следующеме примере код определяет простую форму поиска и список результатов в виде таблицы. Страница состоит из  HTML5 элементов и CSS информации согласно документации Bootstrap. На рисунке показан вид страницы в Mozilla Firefox 10<br><a href="https://camo.githubusercontent.com/96871c2942eb0a4eafa4e0c7657a3171e3bdc887/687474703a2f2f75706c6f61642e77696b696d656469612e6f72672f77696b6970656469612f636f6d6d6f6e732f642f64302f547769747465722d626f6f7473747261702d6578616d706c652d66697265666f782d31302e706e67" target="_blank"><img src="https://camo.githubusercontent.com/96871c2942eb0a4eafa4e0c7657a3171e3bdc887/687474703a2f2f75706c6f61642e77696b696d656469612e6f72672f77696b6970656469612f636f6d6d6f6e732f642f64302f547769747465722d626f6f7473747261702d6578616d706c652d66697265666f782d31302e706e67" alt="Fig 1" data-canonical-src="http://upload.wikimedia.org/wikipedia/commons/d/d0/Twitter-bootstrap-example-firefox-10.png" style="max-width:100%;"></a></p>

<div class="highlight highlight-html"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Example of Twitter Bootstrap<span class="nt">&lt;/title&gt;</span>
    <span class="c">&lt;!-- Подключаем таблицы стилей --&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/head&gt;</span>

  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>Search<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;label&gt;</span>Example for a simple search form.<span class="nt">&lt;/label&gt;</span>

      <span class="c">&lt;!-- Форма поиска с полем ввода и кнопкой --&gt;</span>
      <span class="nt">&lt;form</span> <span class="na">class=</span><span class="s">"well form-search"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"input-medium search-query"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn btn-primary"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/button&gt;</span>
      <span class="nt">&lt;/form&gt;</span>

      <span class="nt">&lt;h2&gt;</span>Results<span class="nt">&lt;/h2&gt;</span>

      <span class="c">&lt;!-- Table with alternating cell background color and outer frame --&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-striped table-bordered"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>#<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;</span>1<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>Lorem ipsum dolor ...<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;</span>2<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>Ut enim ad minim veniam, ...<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;</span>3<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>Duis aute irure dolor ...<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
      <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="c">&lt;!-- Опционально: Подключаем библиотеку jQuery --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"//code.jquery.com/jquery-1.7.2.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

    <span class="c">&lt;!-- Опционально: Подключаем Bootstrap JavaScript плагины --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<h3><a href="http://getbootstrap.com/css/#grid">Сетка</a></h3>

<p>Сетка используется для создания страниц с помощью строк и колонок, вмещающих в себя контент. Как оно работает:</p>

<ul class="task-list">
<li>Строки используются для создания горизонтальных групп колонок.</li>
<li>Контент размещается внутри колонок, и только колонки могут быть непосредственными детьми строк.</li>
<li>Доступны предопределенные классы сетки, например .row и .col-xs-4.</li>
<li>Элементы можно охватить одной из двеннадцати колонок. Например, для трех одинаковых используется <code>.col-md-4</code>
</li>
</ul><p>Простая двухколонная страничка. Первая колонка занимает треть ширины, вторая -- две трети.</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-8"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>Все это требует очень мало усилий и конечный результат выглядит довольно профессионально. Минимум усилий является одной из причин, почему множество людей и компаний по всему миру работают с Twitter Bootstrap или аналогичными фреймворками.</p>

<h1>3 РАЗРАБОТКА САЙТА</h1>

<h3>IDE</h3>

<p>Для Ruby пока не существует совершенных IDE (хотя некоторые среды разработки уже на подходе). Вместо них большинство Rails-разработчиков используют текстовые редакторы. Оказывается, не стоит драматизировать ситуацию. Используя другие, менее выразительные языки, программисты полагаются на IDE для того, чтобы она делала за них большую часть рутинной работы: генерировала код, помогала осуществлять навигацию по файловой системе и проводила постоянную компиляцию, моментально выдавая предупреждения об ошибках. При работе с Ruby такая мощная поддержка просто ни к чему. Текстовые редакторы, наподобие emacs, vi или Sublime Text, предоставят 90% всего, что можно получить IDE, выступая при этом в более легком весе. Пожалуй, единственно полезной из утраченных функций IDE будет поддержка мгновенной проверки кода.</p>

<h2>3.1 Установка Ruby on Rails</h2>

<p>Сперва нам необходимо установить и настроить RVM -- Ruby version manager -- программу для управления версиями Ruby.</p>

<pre><code>$ \curl -sSL https://get.rvm.io | bash
</code></pre>

<p>Основные его задачи:<br>
1. Физическое разделение версий ruby и наборов гемов<br>
2. Возможность иметь несколько версий ruby и переключаться между ними<br>
3. Возможность для каждой версии ruby иметь несколько gemsets — наборов гемов</p>

<p>Устанавливаем ruby 2.1.0</p>

<pre><code>$ rvm install 2.1.0
</code></pre>

<p>Создаем отдельный gemset для нашего проекта и переключимся в него</p>

<pre><code>$ rvm use 2.1.0-head@asmart_reserve --create
</code></pre>

<p>Установим Rails 4.0.3</p>

<pre><code>$ gem install rails --version 4.0.3
</code></pre>

<p>Теперь, имея установленную среду Rails, давайте перейдем к ее использованию. </p>

<h2>3.2 Создание нового приложения</h2>

<p>При установке среды Rails устанавливается новый инструмент командной строки, rails, который используется для конструирования каждого нового Rails-приложения. </p>

<pre lang="shell"><code>$ rails new SmartReserve
create
create README
create Rakefile
create config.ru
:
:
:
create vendor/plugins
create vendor/plugins/.gitkeep
run bundle install
Fetching source index for http://rubygems.org/
:
:
:
Your bundle is complete!
Use 'bundle show [gemname]' to see where a bundled gem is installed.
</code></pre>

<p>Команда создала каталог SmartReserve. Включенные туда файлы уже представляют все, что нужно для запуска автономного веб-сервера, способного выполнять наше только что созданное приложение.</p>

<pre lang="shell"><code>  $ cd SmartReserve
  SmartReserve&gt; rails server
  =&gt; Booting WEBrick
  =&gt; Rails 4.0.3 application starting on http://0.0.0.0:3000
  =&gt; Call with -d to detach
  =&gt; Ctrl-C to shutdown server
  [2011-07-23 10:38:18] INFO WEBrick 1.3.1
  [2011-07-23 10:38:18] INFO ruby 2.1.0 (2014-05-10) [x86_64-linux]
  [2011-07-23 10:38:18] INFO WEBrick::HTTPServer#start: pid=6044 port=3000
</code></pre>

<p>В последней строчке трассировка запуска показывает, что мы только что запустили веб-сервер с использованием порта 3000. Мы можем получить доступ к приложению, указав веб-браузеру URL-адрес http://localhost:3000. Результат показан на рис. 2<br><a href="2%20development/fig.2.png" target="_blank"><img src="2%20development/fig.2.png" alt="fig. 2" style="max-width:100%;"></a><br><em>Рис. 2</em></p>

<h2>3.3 Создание базы данных</h2>

<h3>Общие положения проектирования БД</h3>

<p>Процесс разработки базы данных системы SmartReserve как и процесс разработки любой другой базы делится на три этапа моделирования:</p>

<ul class="task-list">
<li>Инфологический - Описание предметной области, нет привязки к СУБД, предназначено «для людей». </li>
<li>Даталогический - Модель предметной области в привязке к СУБД определённого вида или к конкретной СУБД.</li>
<li>Физический - Таблицы, связи, индексы, методы хранения, настройки производительности, безопасности и т.п.</li>
</ul><h3>Инфологический</h3>

<p>В БД необходимо хранить:</p>

<ul class="task-list">
<li>Пользователей</li>
<li>Заведения</li>
<li>Заказы</li>
</ul><p>Исходя из этого, имеем следущие таблицы:<br><em>Админ</em><br>
1. Email</p>

<p><em>Пользователь</em><br>
1. Email<br>
2. Телефон<br>
3. Роль<br>
4. Локаль<br>
5. Аватар</p>

<p><em>Заведение</em><br>
1. Имя<br>
2. Количество столов<br>
3. Описание<br>
4. График работы<br>
5. Телефон<br>
6. Адрес<br>
7. Аватар<br>
8. Средний чек<br>
9. Город<br>
10. Рейтинг<br>
11. Веб-страница<br>
12. Станция метро<br>
13. Почта</p>

<p><em>Заказ</em><br>
1. Столик<br>
2. Время<br>
3. Номер телефона<br>
4. Имя<br>
5. Код подтверждения<br>
6. Комментарий</p>

<p><em>Столик</em><br>
1. Заведение<br>
2. Номер<br>
3. Количество мест</p>

<h3>Даталогический</h3>

<h4>Active Record</h4>

<p>В Ruby on Rails приложениях для гибкой разработки базы данных используется Active Record.</p>

<h4>Active Record как паттерн</h4>

<p>Active Record это M в MVC -- модель, которая является слоем в системе, ответственным за представление бизнес-логики и данных. Active Record упрощает создание и использование бизнес-объектов, данные которых требуют постоянного хранения в базе данных. Сама по себе эта реализация паттерна Active Record является описанием системы ORM (Object Relational Mapping).<br>
Active Record был описан Martin Fowler в его книге Patterns of Enterprise Application Architecture. В Active Record объекты содержат и сохраненные данные, и поведение, которое работает с этими данными. Active Record исходит из мнения, что обеспечение логики доступа к данным как части объекта покажет пользователям этого объекта то, как читать и писать в базу данных.</p>

<h4>Active Record -- это фреймворк ORM</h4>

<p>Ввиду того, что в Rails Active Record является по сути слоем абстракции над физическим уровнем, то третий этап проектирования ниверлируется и предсталяет собой взаимодействие с высокоуровневым Active Record.<br>
Active Record предоставляет нам несколько механизмов, наиболее важными являются:</p>

<ul class="task-list">
<li>Представления моделей и их данных.</li>
<li>Представления связей между этими моделями.</li>
<li>Представления иерархий наследования с помощью связанных моделей.</li>
<li>Валидации моделей до того, как они будут сохранены в базу данных.</li>
<li>Выполнения операций с базой данных в объктно-ориентированном стиле</li>
</ul><h2>3.4 Генерирование временной платформы</h2>

<p>Нам нужно создать таблицу базы данных и модель Rails, которая позволит нашему приложению использовать эту таблицу, а также создать ряд представлений для формирования пользовательского интерфейса и контроллер, управляющий приложением.Итак, давайте создадим для нашей таблицы products модель, представления,контроллер и миграцию. Все это можно сделать с помощью одной команды, попросив Rails сгенерировать то, что называется временной платформой -- scaffold (англ. строительные леса) для заданной модели. Отметим, что слово в командной строке используется в форме единственного числа — Club. В Rails модель автоматически отображается на таблицу базы данных, чье имя является формой множественного числа класса модели. В нашем случае мы запросилимодель под названием Club, поэтому Rails связывает ее с таблицей по имени clubs.</p>

<pre lang="shell"><code>SmartReserve&gt; rails generate scaffold Club name:string description:text avatar_url:string price:decimal
      invoke  active_record
      create    db/migrate/20140510103446_create_clubs.rb
      create    app/models/club.rb
      invoke    test_unit
      create      test/models/club_test.rb
      create      test/fixtures/clubs.yml
      invoke  resource_route
       route    resources :clubs
      invoke  scaffold_controller
      create    app/controllers/clubs_controller.rb
      invoke    erb
      create      app/views/clubs
      create      app/views/clubs/index.html.erb
      create      app/views/clubs/edit.html.erb
      create      app/views/clubs/show.html.erb
      create      app/views/clubs/new.html.erb
      create      app/views/clubs/_form.html.erb
      invoke    test_unit
      create      test/controllers/clubs_controller_test.rb
      invoke    helper
      create      app/helpers/clubs_helper.rb
      invoke      test_unit
      create        test/helpers/clubs_helper_test.rb
      invoke    jbuilder
      create      app/views/clubs/index.json.jbuilder
      create      app/views/clubs/show.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/clubs.js.coffee
      invoke    scss
      create      app/assets/stylesheets/clubs.css.scss
      invoke  scss
      create    app/assets/stylesheets/scaffolds.css.scss

</code></pre>

<p>Генератор создал целый пакет файлов. Нас в первую очередь интересует файл миграции <code>20140510103446_create_clubs.rb</code><br>
В файле миграции записаны изменения, которые нужно провести с базой данных. Для приминения миграции используем команду rake:</p>

<pre lang="shell"><code>SmartReserve&gt; rake db:migrate
== 20140510103446 CreateClubs: migrating ======================================
-- create_table(:clubs)
   -&gt; 0.0039s
== 20140510103446 CreateClubs: migrated (0.0044s) =============================
</code></pre>

<p>Подключимся к серверу (рис. 3)<br><a href="2%20development/fig.3.png" target="_blank"><img src="2%20development/fig.3.png" alt="fig.3" style="max-width:100%;"></a><br><em>Рис. 3</em><br>
Список заведений пуст. Перейдем по ссылке New Club и добавим что-нибудь (рис. 4)<br><a href="2%20development/fig.4.png" target="_blank"><img src="2%20development/fig.4.png" alt="fig.4" style="max-width:100%;"></a><br><em>Рис. 4</em><br>
Щелкнем по кнопке Create и видим, что новая запись успешно сохранена (рис. 5)<br><a href="2%20development/fig.5.png" target="_blank"><img src="2%20development/fig.5.png" alt="fig.5" style="max-width:100%;"></a><br><em>Рис. 5</em><br>
Эти формы были сгенерированы автоматически. Они лежат в <code>/app/views/clubs</code>.</p>

<div class="highlight highlight-html"><pre><span class="c">&lt;!-- app/views/clubs/index.html.erb - список заведений--&gt;</span>
<span class="nt">&lt;h1&gt;</span>Listing clubs<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>Description<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>Avatar url<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>Average price<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>

  <span class="nt">&lt;tbody&gt;</span>
    <span class="err">&lt;</span>% @clubs.each do |club| %&gt;
      <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= club.name %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= club.description %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= club.avatar_url %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= club.average_price %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= link_to 'Show', club %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= link_to 'Edit', edit_club_path(club) %&gt;<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= link_to 'Destroy', club, method: :delete, data: { confirm: 'Are you sure?' } %&gt;<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
    <span class="err">&lt;</span>% end %&gt;
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;br&gt;</span>

<span class="err">&lt;</span>%= link_to 'New Club', new_club_path %&gt;
</pre></div>

<p>В дальнейшем эти странички будут полностью переделаны.</p>

<h2>3.5 Подключение плагинов</h2>

<p>Для быстрой разработки будем использовать Twitter Bootstrap и шаблонизатор Slim.<br>
Рассмотрим файл Gemfile в корне нашего проекта. Здесь перечисляются все гемы, используемые нашим проектом. Добавим к ним гемы slim и bootstrap-sass</p>

<div class="highlight highlight-ruby"><pre><span class="c1"># ./Gemfile</span>
<span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'slim'</span>
<span class="n">gem</span> <span class="s1">'bootstrap-sass'</span>

<span class="c1"># Bundle edge Rails instead: gem 'rails', github: 'rails/rails'</span>
<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span> <span class="s1">'4.1.1'</span>
<span class="c1"># Use sqlite3 as the database for Active Record</span>
<span class="n">gem</span> <span class="s1">'sqlite3'</span>
<span class="c1"># Use SCSS for stylesheets</span>
<span class="n">gem</span> <span class="s1">'sass-rails'</span><span class="p">,</span> <span class="s1">'~&gt; 4.0.3'</span>
<span class="c1"># Use Uglifier as compressor for JavaScript assets</span>
<span class="n">gem</span> <span class="s1">'uglifier'</span><span class="p">,</span> <span class="s1">'&gt;= 1.3.0'</span>
<span class="c1"># Use CoffeeScript for .js.coffee assets and views</span>
<span class="n">gem</span> <span class="s1">'coffee-rails'</span><span class="p">,</span> <span class="s1">'~&gt; 4.0.0'</span>
<span class="c1"># See https://github.com/sstephenson/execjs#readme for more supported runtimes</span>
<span class="c1"># gem 'therubyracer',  platforms: :ruby</span>

<span class="c1"># Use jquery as the JavaScript library</span>
<span class="n">gem</span> <span class="s1">'jquery-rails'</span>
<span class="c1"># Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks</span>
<span class="n">gem</span> <span class="s1">'turbolinks'</span>
<span class="c1"># Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder</span>
<span class="n">gem</span> <span class="s1">'jbuilder'</span><span class="p">,</span> <span class="s1">'~&gt; 2.0'</span>
<span class="c1"># bundle exec rake doc:rails generates the API under doc/api.</span>
<span class="n">gem</span> <span class="s1">'sdoc'</span><span class="p">,</span> <span class="s1">'~&gt; 0.4.0'</span><span class="p">,</span>          <span class="ss">group</span><span class="p">:</span> <span class="ss">:doc</span>

<span class="c1"># Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring</span>
<span class="n">gem</span> <span class="s1">'spring'</span><span class="p">,</span>        <span class="ss">group</span><span class="p">:</span> <span class="ss">:development</span>

<span class="c1"># Use ActiveModel has_secure_password</span>
<span class="c1"># gem 'bcrypt', '~&gt; 3.1.7'</span>

<span class="c1"># Use unicorn as the app server</span>
<span class="c1"># gem 'unicorn'</span>

<span class="c1"># Use Capistrano for deployment</span>
<span class="c1"># gem 'capistrano-rails', group: :development</span>

<span class="c1"># Use debugger</span>
<span class="c1"># gem 'debugger', group: [:development, :test]</span>
</pre></div>

<p>Воспользуемся командой bundle, чтобы установить их</p>

<pre><code>SmartReserve&gt; bundle install
</code></pre>

<p><a href="http://stackoverflow.com/questions/10347572/convert-erb-template-to-slim">Переведем</a> наши erb шаблоны в slim формат:</p>

<pre lang="shell"><code>SmartReserve&gt; cd app/views
# Сперва перейдем на haml - еще один язык шаблонов
SmartReserve/app/views&gt; gem install haml # https://github.com/haml/haml
SmartReserve/app/views&gt; gem install html2haml
SmartReserve/app/views&gt; gem install hpricot
SmartReserve/app/views&gt; gem install ruby_parser
SmartReserve/app/views&gt; find . -name '*erb' | \
xargs ruby -e 'ARGV.each { |i| puts "html2haml -r #{i} #{i.sub(/erb$/,"haml")}"}' | \
bash

# Переходим от haml к slim
SmartReserve/app/views&gt; gem install haml2slim # https://github.com/fredwu/haml2slim
SmartReserve/app/views&gt; find . -name '*haml' | \
xargs ruby -e 'ARGV.each { |i| puts "haml2slim #{i} #{i.sub(/haml$/,"slim")}"}' | \
bash

# Удаляем ненужные более файлы
SmartReserve/app/views&gt; find . -name '*erb' -exec rm -f {} \;
SmartReserve/app/views&gt; find . -name '*haml' -exec rm -f {} \;

# И гемы
SmartReserve/app/views&gt; gem uninstall haml
SmartReserve/app/views&gt; gem uninstall html2haml
SmartReserve/app/views&gt; gem uninstall hpricot
SmartReserve/app/views&gt; gem uninstall ruby_parser
SmartReserve/app/views&gt; gem uninstall haml2slim
</code></pre>

<p>И вот, обновленный index.html.slim</p>

<div class="highlight highlight-css"><pre><span class="nt">h1</span> <span class="nt">Listing</span> <span class="nt">clubs</span>
<span class="nt">table</span>
  <span class="nt">thead</span>
    <span class="nt">tr</span>
      <span class="nt">th</span> <span class="nt">Name</span>
      <span class="nt">th</span> <span class="nt">Description</span>
      <span class="nt">th</span> <span class="nt">Avatar</span> <span class="nt">url</span>
      <span class="nt">th</span> <span class="nt">Average</span> <span class="nt">price</span>
      <span class="nt">th</span> <span class="nt">colspan</span><span class="o">=</span><span class="s2">"3"</span> 
  <span class="nt">tbody</span>
    <span class="nt">-</span> <span class="k">@clubs</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">club</span><span class="o">|</span>
      <span class="nt">tr</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">club</span><span class="nc">.name</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">club</span><span class="nc">.description</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">club</span><span class="nc">.avatar_url</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">club</span><span class="nc">.average_price</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">link_to</span> <span class="s1">'Show'</span><span class="o">,</span> <span class="nt">club</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">link_to</span> <span class="s1">'Edit'</span><span class="o">,</span> <span class="nt">edit_club_path</span><span class="o">(</span><span class="nt">club</span><span class="o">)</span>
        <span class="nt">td</span> <span class="o">=</span> <span class="nt">link_to</span> <span class="s1">'Destroy'</span><span class="o">,</span> <span class="nt">club</span><span class="o">,</span> <span class="nt">method</span><span class="o">:</span> <span class="nd">:delete</span><span class="o">,</span> <span class="nt">data</span><span class="o">:</span>   <span class="nt">confirm</span><span class="o">:</span> <span class="s1">'Are you sure?'</span>  
<span class="nt">br</span><span class="o">/</span>
<span class="o">=</span> <span class="nt">link_to</span> <span class="s1">'New Club'</span><span class="o">,</span> <span class="nt">new_club_path</span>
</pre></div>

<p>Чтобы использовать Twitter Bootstrap добавим следующую строку в файл <code>app/assets/stylesheets/application.css</code></p>

<div class="highlight highlight-css"><pre><span class="c">/*</span>
<span class="c"> * This is a manifest file that'll be compiled into application.css, which will include all the files</span>
<span class="c"> * listed below.</span>
<span class="c"> *</span>
<span class="c"> * Any CSS and SCSS file within this directory, lib/assets/stylesheets, vendor/assets/stylesheets,</span>
<span class="c"> * or vendor/assets/stylesheets of plugins, if any, can be referenced here using a relative path.</span>
<span class="c"> *</span>
<span class="c"> * You're free to add application-wide styles to this file and they'll appear at the bottom of the</span>
<span class="c"> * compiled file so the styles you add here take precedence over styles defined in any styles</span>
<span class="c"> * defined in the other CSS/SCSS files in this directory. It is generally better to create a new</span>
<span class="c"> * file per style scope.</span>
<span class="c"> *</span>
<span class="c"> *= require_tree .</span>
<span class="c"> *= require_self</span>
<span class="c"> *= require bootstrap</span>
<span class="c"> */</span>
</pre></div>

<p>Убедимся, что новые стили подключились (рис. 6)<br><a href="2%20development/fig.6.png" target="_blank"><img src="2%20development/fig.6.png" alt="fig.6" style="max-width:100%;"></a><br><em>Рис. 6</em></p>

<h2>3.6 Модели</h2>

<h3>Столик</h3>

<p>Помимо уже существующих модели заведения <code>Club</code> нам понадобятся модели столика и заказа.</p>

<pre lang="shell"><code>SmartReserve&gt; rails g model Table seats:integer
      invoke  active_record
      create    db/migrate/20140510161000_create_tables.rb
      create    app/models/table.rb
      invoke    test_unit
      create      test/models/table_test.rb
      create      test/fixtures/tables.yml
</code></pre>

<p>Столик принадлежит заведению, поэтому поправим файл миграции <code>db/migrate/20140510161000_create_tables.rb</code></p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">CreateTables</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">create_table</span> <span class="ss">:tables</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="o">.</span><span class="n">integer</span> <span class="ss">:seats</span>

      <span class="c1"># создаст поле club_id в таблице столиков</span>
      <span class="n">t</span><span class="o">.</span><span class="n">belongs_to</span> <span class="ss">:club</span>
      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>И классы моделей:<br>
столика <code>app/models/table.rb</code></p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">Table</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Чудеса метапрограммирования Ruby. Эта строка генерирует метод Table#club,</span>
  <span class="c1"># который будет возвращать соответствующий ресторан</span>
  <span class="n">belongs_to</span> <span class="ss">:club</span>
<span class="k">end</span>
</pre></div>

<p>и заведения <code>app/models/club.rb</code></p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">Club</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># генерирует метод Club#tables, который будет возвращать коллекцию столиков ресторана</span>
  <span class="n">has_many</span> <span class="ss">:tables</span> 
<span class="k">end</span>
</pre></div>

<p>Проведем миграцию</p>

<pre lang="shell"><code>SmartReserve&gt; rake db:migrate
</code></pre>

<h3>Заказ</h3>

<p>В информации о заказе будут время, номер телефона и имя клиента. Также заказ принадлежит ресторану и столику.</p>

<pre lang="shell"><code>SmartReserve&gt; rails g scaffold Order name:string phone:string time:datetime
</code></pre>

<div class="highlight highlight-ruby"><pre><span class="c1"># db/migrate/20140510163608_create_orders.rb</span>
<span class="k">class</span> <span class="nc">CreateOrders</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">create_table</span> <span class="ss">:orders</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="o">.</span><span class="n">string</span> <span class="ss">:name</span>
      <span class="n">t</span><span class="o">.</span><span class="n">string</span> <span class="ss">:phone</span>
      <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:time</span>
      <span class="n">t</span><span class="o">.</span><span class="n">belongs_to</span> <span class="ss">:club</span>
      <span class="n">t</span><span class="o">.</span><span class="n">belongs_to</span> <span class="ss">:table</span>
      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># app/models/order.rb</span>
<span class="k">class</span> <span class="nc">Order</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:club</span>
  <span class="n">belongs_to</span> <span class="ss">:table</span>
<span class="k">end</span>

<span class="c1"># app/models/table.rb</span>
<span class="k">class</span> <span class="nc">Table</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:club</span>
  <span class="n">has_many</span> <span class="ss">:orders</span>
<span class="k">end</span>

<span class="c1"># app/models/club.rb</span>
<span class="k">class</span> <span class="nc">Club</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:tables</span>
  <span class="n">has_many</span> <span class="ss">:orders</span>
<span class="k">end</span>
</pre></div>

<p>Применим миграцию</p>

<pre lang="shell"><code>SmartReserve&gt; rake db:migrate
</code></pre>

<p>Теперь в моделях есть почти все необходимое для решения нашей задачи.</p>

<h1>4 ЛИСТИНГ СТРАНИЦ ВЕБ-САЙТА</h1>

<h2>4.1 Каталог заведений</h2>

<p><a href="2%20development/fig.7.png" target="_blank"><img src="2%20development/fig.7.png" alt="fig.7" style="max-width:100%;"></a><br><em>Рис. 7 Каталог заведений</em><br>
Ранее нами был сгенерирован файл <code>app/controllers/clubs_controller.rb</code>, в котором уже описан стандартный набор CRUD (create, read, update, destroy) действий с заведениями.<br>
Теперь улучшим представление, используя Slim, Bootstrap и Scss:</p>

<div class="highlight highlight-scss"><pre><span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">clubs</span><span class="o">/</span><span class="nt">index</span><span class="nc">.html.slim</span>
    <span class="o">/</span> <span class="err">Форма</span> <span class="err">поиска</span> <span class="err">фиксированной</span> <span class="err">ширины</span>
    <span class="nc">.container-fixed</span>
      <span class="nc">.row</span>
        <span class="o">/</span><span class="nc">.col-md-offset-2</span>  <span class="nt">--</span> <span class="err">сдвиг</span> <span class="err">на</span> <span class="err">две</span> <span class="err">колонки</span>
        <span class="nc">.col-md-2.col-md-offset-2</span>
          <span class="nc">.catalog-filter</span>
            <span class="o">/</span> <span class="err">Хелпер</span><span class="o">,</span> <span class="err">создающий</span> <span class="err">тэг</span> <span class="o">&lt;</span><span class="nt">form</span><span class="o">&gt;</span>
            <span class="o">=</span> <span class="nt">form_tag</span> <span class="s1">'</span><span class="s2">/catalog'</span><span class="o">,</span> <span class="nd">:method</span> <span class="o">=&gt;</span> <span class="nd">:get</span> <span class="nt">do</span>
              <span class="nt">label</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s2">"font-size:18px"</span><span class="o">]</span> <span class="err">Подобрать</span> <span class="err">заведение</span>
              <span class="nt">label</span> <span class="err">Город</span><span class="nd">:</span>
              <span class="nt">select</span><span class="o">[</span><span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">city'</span><span class="o">]</span>
                <span class="nt">option</span><span class="o">[</span><span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">Minsk'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">city'</span><span class="o">]</span> <span class="nt">Minsk</span>
              <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">text'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">name'</span> <span class="nt">placeholder</span><span class="o">=</span><span class="s1">'</span><span class="s2">Поиск по названию'</span> <span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">width:100%'</span><span class="o">]</span>
              <span class="nt">br</span>

              <span class="o">/</span> <span class="err">Слайдер</span> <span class="err">для</span> <span class="err">выбора</span> <span class="err">интервала</span> <span class="err">среднего</span> <span class="err">чека</span> <span class="err">сделан</span> <span class="err">с</span> <span class="err">помощью</span> <span class="nt">jQuery-</span><span class="err">плагина</span> <span class="nt">noUiSlider</span>
                <span class="nt">http</span><span class="nd">:</span><span class="o">//</span><span class="nt">refreshless</span><span class="nc">.com</span><span class="o">/</span><span class="nt">nouislider</span><span class="o">/</span>
              <span class="nc">.average-price</span> <span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">padding-top:5px'</span>
                <span class="nt">label</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">padding-bottom:5px'</span><span class="o">]</span> <span class="err">Средний</span> <span class="err">чек</span>                
                <span class="nn">#average_price_wrapper</span>
                  <span class="nn">#average_price_range</span>
                <span class="nt">input</span><span class="nn">#input_from</span> <span class="nt">name</span><span class="o">=</span><span class="s2">"price[from]"</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"width:45%"</span>
                <span class="o">|</span>  
                <span class="nt">input</span><span class="nn">#input_to</span> <span class="nt">name</span><span class="o">=</span><span class="s2">"price[to]"</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"width:45%;float:right"</span>

              <span class="o">/</span> <span class="nc">.styled</span> <span class="nt">-</span> <span class="err">специальный</span> <span class="err">класс</span> <span class="err">для</span> <span class="err">нестандартных</span> <span class="err">перекючателей</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">table_kind'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">smoke'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Курящий</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">table_kind'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">nonsmoke'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Некурящий</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">table_kind'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">terrace'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Терраса</span>
              <span class="nt">br</span>

              <span class="o">/</span> <span class="nt">Type</span><span class="o">,</span> <span class="nt">Interior</span><span class="o">,</span> <span class="nt">Atmosphere</span><span class="o">,</span> <span class="nt">Feature</span><span class="o">,</span> <span class="nt">Kitchen</span> <span class="nt">--</span> <span class="err">модели</span> <span class="err">соответствующих</span> <span class="err">параметров</span> <span class="err">заведения</span>
                <span class="err">Для</span> <span class="err">каждого</span> <span class="err">из</span> <span class="err">параметров</span> <span class="err">существует</span> <span class="err">диалоговое</span> <span class="err">окно</span>
                <span class="err">В</span> <span class="nt">Bootstrap</span> <span class="err">уже</span> <span class="err">есть</span> <span class="err">готовые</span> <span class="err">стили</span> <span class="err">и</span> <span class="err">скрипты</span> <span class="err">для</span> <span class="err">диалоговых</span> <span class="err">окон</span>
              <span class="nt">label</span> <span class="err">Интерьер</span> 
              <span class="o">/</span> <span class="err">Атрибут</span> <span class="nt">data-toggle</span><span class="o">=</span><span class="s2">"modal"</span> <span class="err">говорит</span><span class="o">,</span> <span class="err">что</span> <span class="err">клик</span> <span class="err">по</span> <span class="err">ссылке</span> <span class="err">вызовет</span> <span class="err">диаоговое</span> <span class="err">окно</span> <span class="err">с</span> <span class="nt">id</span> <span class="err">указанным</span> <span class="err">в</span> <span class="nt">data-target</span> <span class="nt">--</span> <span class="err">в</span> <span class="err">этом</span> <span class="err">случае</span> <span class="s2">"interior_modal"</span>
              <span class="nt">a</span><span class="nc">.align-right</span><span class="o">[</span><span class="nt">href</span><span class="o">=</span><span class="s1">'</span><span class="s2">#'</span> <span class="nt">onclick</span><span class="o">=</span><span class="s1">'</span><span class="s2">'</span> <span class="nt">data-toggle</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">data-target</span><span class="o">=</span><span class="s2">"#interior_modal"</span><span class="o">]</span>  <span class="err">Выбрать</span>

              <span class="o">/</span> <span class="err">Так</span> <span class="err">как</span> <span class="err">у</span> <span class="err">нас</span> <span class="err">три</span> <span class="err">одинаковых</span> <span class="err">окна</span><span class="o">,</span> <span class="err">различающиеся</span> <span class="err">только</span> <span class="err">содержимым</span><span class="o">,</span> <span class="err">код</span> <span class="err">окна</span> <span class="err">вынесен</span> <span class="err">в</span> <span class="err">отдельный</span> <span class="err">файл</span> <span class="nt">--</span> 
                <span class="err">парциал</span> <span class="o">(</span><span class="err">англ</span><span class="nc">.</span> <span class="nt">partial</span><span class="o">)</span> <span class="nt">--</span> <span class="s1">'</span><span class="s2">clubs/_modal_with_checkboxes.html.slim'</span><span class="o">,</span> <span class="err">который</span> <span class="err">вставляется</span> <span class="err">в</span> <span class="err">страницу</span> <span class="err">методом</span> <span class="nt">render</span><span class="nc">.</span> <span class="err">Внутри</span> <span class="err">парциала</span> <span class="err">будут</span> <span class="err">доступны</span> <span class="err">переменные</span> <span class="nt">properties</span><span class="o">,</span> <span class="nt">id</span> <span class="err">и</span> <span class="nt">checked_properties</span> <span class="err">с</span> <span class="err">соответствующими</span> <span class="err">значениями</span>              
              <span class="o">==</span> <span class="nt">render</span> <span class="s1">'</span><span class="s2">clubs/modal_with_checkboxes'</span><span class="o">,</span> <span class="nd">:properties</span> <span class="o">=&gt;</span> <span class="nt">Interior</span><span class="nc">.all</span><span class="o">,</span> <span class="nd">:id</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">interior_modal'</span><span class="o">,</span> <span class="nd">:checked_properties</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nt">checked_properties</span>
              <span class="nt">br</span>

              <span class="nt">label</span> <span class="err">Атмосфера</span> 
              <span class="nt">a</span><span class="nc">.align-right</span><span class="o">[</span><span class="nt">href</span><span class="o">=</span><span class="s1">'</span><span class="s2">#'</span> <span class="nt">onclick</span><span class="o">=</span><span class="s1">'</span><span class="s2">'</span> <span class="nt">data-toggle</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">data-target</span><span class="o">=</span><span class="s2">"#atmosphere_modal"</span><span class="o">]</span>  <span class="err">Выбрать</span>
              <span class="o">==</span> <span class="nt">render</span> <span class="s1">'</span><span class="s2">clubs/modal_with_checkboxes'</span><span class="o">,</span> <span class="nd">:properties</span> <span class="o">=&gt;</span> <span class="nt">Atmosphere</span><span class="nc">.all</span><span class="o">,</span> <span class="nd">:id</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">atmosphere_modal'</span><span class="o">,</span> <span class="nd">:checked_properties</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nt">checked_properties</span>
              <span class="nt">br</span>

              <span class="nt">label</span> <span class="err">Тип</span> <span class="err">заведения</span> 
              <span class="nt">a</span><span class="nc">.align-right</span><span class="o">[</span><span class="nt">href</span><span class="o">=</span><span class="s1">'</span><span class="s2">#'</span> <span class="nt">onclick</span><span class="o">=</span><span class="s1">'</span><span class="s2">'</span> <span class="nt">data-toggle</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">data-target</span><span class="o">=</span><span class="s2">"#club_type_modal"</span><span class="o">]</span>  <span class="err">Выбрать</span>
              <span class="o">==</span> <span class="nt">render</span> <span class="s1">'</span><span class="s2">clubs/modal_with_checkboxes'</span><span class="o">,</span> <span class="nd">:properties</span> <span class="o">=&gt;</span> <span class="nt">Type</span><span class="nc">.all</span><span class="o">,</span> <span class="nd">:id</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">club_type_modal'</span><span class="o">,</span> <span class="nd">:checked_properties</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nt">checked_properties</span>
              <span class="nt">br</span>

              <span class="nt">label</span> <span class="err">Особенности</span><span class="nd">:</span>
              <span class="nt">br</span>
              <span class="nn">#features</span>
                <span class="o">/</span> <span class="err">Шесть</span> <span class="err">первых</span> <span class="err">особенностей</span> <span class="err">видны</span> <span class="err">на</span> <span class="err">форме</span>
                <span class="nt">-</span> <span class="nt">Feature</span><span class="nc">.limit</span><span class="o">(</span><span class="nt">6</span><span class="o">)</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">property</span><span class="o">|</span>
                  <span class="o">/</span> <span class="err">хелпер</span> <span class="err">для</span> <span class="o">&lt;</span><span class="nt">input</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"checkbox"</span><span class="o">&gt;</span>
                  <span class="o">/</span> <span class="err">первый</span> <span class="err">параметр</span> <span class="err">задает</span> <span class="err">атрибут</span> <span class="nt">name</span>
                  <span class="o">/</span> <span class="err">второй</span> <span class="nt">--</span> <span class="nt">value</span>
                  <span class="o">/</span> <span class="err">третий</span> <span class="nt">--</span> <span class="nt">checked</span>
                  <span class="o">/</span> <span class="err">четвертый</span> <span class="nt">--</span> <span class="err">хэш</span> <span class="err">со</span> <span class="err">всеми</span> <span class="err">остальными</span> <span class="err">атрибутами</span>
                  <span class="o">=</span> <span class="nt">check_box_tag</span> <span class="s1">'</span><span class="s2">property_ids[]'</span><span class="o">,</span> <span class="nt">property</span><span class="nc">.id</span><span class="o">,</span> <span class="o">@</span><span class="nt">checked_properties</span><span class="nc">.include</span><span class="o">?(</span><span class="nt">property</span><span class="nc">.id</span><span class="o">),</span> <span class="nd">:class</span> <span class="o">=&gt;</span> <span class="s1">'</span><span class="s2">styled'</span>
                  <span class="o">=</span> <span class="nt">property</span><span class="nc">.name</span>
                  <span class="nt">br</span><span class="o">/</span>
              <span class="nt">a</span><span class="nc">.align-right</span><span class="o">[</span><span class="nt">href</span><span class="o">=</span><span class="s1">'</span><span class="s2">#'</span> <span class="nt">onclick</span><span class="o">=</span><span class="s1">'</span><span class="s2">'</span> <span class="nt">data-toggle</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">data-target</span><span class="o">=</span><span class="s2">"#features_modal"</span><span class="o">]</span> <span class="err">Посмотреть</span> <span class="err">все</span>
              <span class="o">==</span> <span class="nt">render</span> <span class="s1">'</span><span class="s2">clubs/modal_with_checkboxes'</span><span class="o">,</span> <span class="nd">:properties</span> <span class="o">=&gt;</span> <span class="nt">Feature</span><span class="nc">.all</span><span class="o">,</span> <span class="nd">:id</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">features_modal'</span><span class="o">,</span> <span class="nd">:checked_properties</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nt">checked_properties</span>
              <span class="nt">br</span>

              <span class="nt">label</span> <span class="err">Кухня</span>
              <span class="o">/</span> <span class="err">Выбор</span> <span class="err">кухни</span> <span class="err">из</span> <span class="err">списка</span>
              <span class="nt">select</span><span class="o">[</span><span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">kitchen'</span><span class="o">]</span>
                <span class="nt">-</span> <span class="nt">Kitchen</span><span class="nc">.all.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">k</span><span class="o">|</span>
                  <span class="nt">option</span><span class="o">[</span><span class="nt">value</span><span class="o">=</span><span class="nt">k</span><span class="nc">.id</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">property_ids[]'</span><span class="o">]</span> <span class="o">=</span> <span class="nt">k</span><span class="nc">.name</span>
              <span class="nt">br</span>
              <span class="nt">label</span> <span class="err">Сортировать</span> <span class="err">по</span><span class="nd">:</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">order_by'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">rating_average'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Популярности</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">order_by'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">closest'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Близости</span><span class="o">(</span><span class="err">ввести</span> <span class="err">улицу</span><span class="o">)</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">order_by'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">average_price'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Доступности</span>
              <span class="nt">br</span>
              <span class="nt">input</span><span class="nc">.styled</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">radio'</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">order_by'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">created_at'</span><span class="o">]</span>
              <span class="nt">label</span> <span class="err">Дате</span> <span class="err">добавления</span>

              <span class="o">/</span> <span class="err">Хелпер</span> <span class="err">для</span> <span class="err">тэга</span> <span class="o">&lt;</span><span class="nt">input</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span> <span class="err">С</span> <span class="err">параметром</span> <span class="nt">remote</span><span class="nd">:</span> <span class="nt">true</span> <span class="err">форма</span> <span class="err">будет</span> <span class="err">передана</span> <span class="err">на</span> <span class="err">сервер</span> <span class="err">с</span> <span class="err">помощью</span> <span class="nt">AJAX</span>
              <span class="o">=</span> <span class="nt">submit_tag</span> <span class="s1">'</span><span class="s2">Применить'</span><span class="o">,</span> <span class="nd">:class</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">btn-reservation btn btn-danger'</span><span class="o">,</span> <span class="nd">:style</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">width:51%'</span><span class="o">,</span> <span class="nt">remote</span><span class="nd">:</span> <span class="nt">true</span><span class="o">,</span> <span class="nt">id</span><span class="nd">:</span> <span class="s1">'</span><span class="s2">submit_tag'</span>
              <span class="o">|</span>  
              <span class="nt">input</span><span class="nc">.btn-reservation.btn.btn-danger</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">'</span><span class="s2">reset'</span> <span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">width:45%'</span> <span class="nt">value</span><span class="o">=</span><span class="s1">'</span><span class="s2">Сбросить'</span><span class="o">]</span>

        <span class="o">/</span> <span class="err">здесь</span> <span class="err">будут</span> <span class="err">показываться</span> <span class="err">результаты</span>
        <span class="nn">#clubs_div</span><span class="nc">.col-md-6</span> <span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">width: calc(50% + 30px);'</span>

          <span class="o">/</span> <span class="err">в</span> <span class="err">переменной</span> <span class="o">@</span><span class="nt">clubs</span> <span class="err">содержатся</span> <span class="err">найденные</span> <span class="err">заведения</span>
          <span class="nt">-</span> <span class="o">@</span><span class="nt">clubs</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">club</span><span class="o">|</span>
              <span class="o">==</span> <span class="nt">render</span> <span class="s1">'</span><span class="s2">clubs/single_club'</span><span class="o">,</span> <span class="nd">:club</span> <span class="o">=&gt;</span> <span class="nt">club</span>

<span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">clubs</span><span class="o">/</span><span class="nt">_modal_with_checkboxes</span><span class="nc">.html.slim</span>
<span class="o">/</span> <span class="err">по</span> <span class="err">соглашению</span> <span class="err">имена</span> <span class="err">файлов</span> <span class="err">с</span> <span class="err">парциаами</span> <span class="err">начинаются</span> <span class="err">с</span> <span class="err">подчеркивания</span>
<span class="nc">.modal.fade</span> <span class="nt">id</span><span class="o">=</span><span class="s2">"</span><span class="si">#{</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span> <span class="nt">aria-hidden</span><span class="o">=</span><span class="s2">"true"</span> <span class="nt">aria-labelledby</span><span class="o">=</span><span class="s2">"features_modalLabel"</span> <span class="nt">role</span><span class="o">=</span><span class="s2">"dialog"</span> <span class="nt">tabindex</span><span class="o">=</span><span class="s2">"-1"</span> 
  <span class="nc">.modal-dialog</span>
    <span class="nc">.modal-content</span>
      <span class="nc">.modal-header</span>
        <span class="o">/</span> <span class="err">кнопка</span> <span class="err">для</span> <span class="err">закрытия</span> <span class="err">диалогового</span> <span class="err">окна</span>
        <span class="nt">button</span><span class="nc">.close</span> <span class="nt">aria-hidden</span><span class="o">=</span><span class="s2">"true"</span> <span class="nt">data-dismiss</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"button"</span>  <span class="k">&amp;</span><span class="nt">times</span><span class="o">;</span>
        <span class="nt">h4</span><span class="nn">#myModalLabel</span><span class="nc">.modal-title.red</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">text-align:center'</span><span class="o">]</span> <span class="err">Особенности</span> <span class="err">заведения</span>
      <span class="nc">.modal-body.row</span>
        <span class="o">/</span> <span class="err">выстроим</span> <span class="err">все</span> <span class="err">параметры</span> <span class="err">в</span> <span class="err">две</span> <span class="err">колонки</span>
        <span class="nt">-</span> <span class="nt">properties</span><span class="nc">.each_slice</span><span class="o">((</span><span class="nt">properties</span><span class="nc">.size</span><span class="o">/</span><span class="nt">2</span><span class="nc">.0</span><span class="o">)</span><span class="nc">.round</span><span class="o">)</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">half</span><span class="o">|</span>
          <span class="nc">.col-md-6</span>
            <span class="nt">-</span> <span class="nt">half</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">property</span><span class="o">|</span>         
              <span class="o">=</span> <span class="nt">check_box_tag</span> <span class="s1">'</span><span class="s2">property_ids[]'</span><span class="o">,</span> <span class="nt">property</span><span class="nc">.id</span><span class="o">,</span> <span class="nt">checked_properties</span><span class="nc">.include</span><span class="o">?(</span><span class="nt">property</span><span class="nc">.id</span><span class="o">),</span><span class="nd">:class</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">styled'</span>
              <span class="nt">label</span> <span class="o">=</span> <span class="nt">property</span><span class="nc">.name</span>
              <span class="nt">br</span><span class="o">/</span>
      <span class="nc">.modal-footer</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"text-align:center"</span>
        <span class="nt">button</span><span class="nc">.btn.btn-red-border</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"padding-top:5px"</span> <span class="nt">data-dismiss</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="err">Отмена</span>
        <span class="nt">button</span><span class="nc">.btn.btn-red-border</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"padding-top:5px"</span> <span class="nt">data-dismiss</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="err">ОК</span>

<span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">clubs</span><span class="o">/</span><span class="nt">_single_club</span><span class="nc">.html.slim</span>
<span class="nc">.club-wrapper-catalog</span>
  <span class="nc">.club-div</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"background-image:url(</span><span class="si">#{</span><span class="n">club</span><span class="o">.</span><span class="n">avatar_url</span><span class="si">}</span><span class="s2">)"</span> 
    <span class="nc">.white-on-avatar</span> <span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">height:50px;margin-top:15px;overflow-x:hidden'</span>
      <span class="o">/</span> <span class="nt">club_path</span> <span class="err">возвращает</span> <span class="err">ссылку</span> <span class="err">на</span> <span class="err">страницу</span> <span class="err">заведения</span>
      <span class="o">/</span> <span class="err">Например</span><span class="o">,</span> <span class="nt">club_path</span><span class="o">(</span><span class="nt">1</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="o">/</span><span class="nt">clubs</span><span class="o">/</span><span class="nt">1</span>
      <span class="nt">a</span><span class="nc">.title-on-avatar</span> <span class="nt">href</span><span class="o">=</span><span class="s2">"</span><span class="si">#{</span><span class="nf">club_path</span><span class="p">(</span><span class="n">club</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span> 
        <span class="o">=</span> <span class="nt">club</span><span class="nc">.name</span>
      <span class="nc">.address-on-avatar</span>
        <span class="o">=</span> <span class="nt">club</span><span class="nc">.get_address</span>
    <span class="nc">.white-on-avatar</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"height:35px;margin-top:95px;"</span>
      <span class="nc">.rating</span>
        <span class="o">/</span> <span class="err">все</span> <span class="err">картинки</span> <span class="err">хранятся</span> <span class="err">в</span> <span class="err">папке</span> <span class="nt">app</span><span class="o">/</span><span class="nt">assets</span><span class="o">/</span><span class="nt">images</span>
        <span class="o">/</span> <span class="err">чтобы</span> <span class="err">получить</span> <span class="err">путь</span> <span class="err">к</span> <span class="err">картинке</span> <span class="err">используется</span> <span class="err">метод</span> <span class="nt">asset_path</span>
        <span class="nt">img</span><span class="nc">.rating-img</span> <span class="nt">src</span><span class="o">=</span><span class="s2">"</span><span class="si">#{</span><span class="nf">asset_path</span><span class="p">(</span><span class="s1">'</span><span class="s2">ajaxful_rating/big_star.png'</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="nt">span</span><span class="nc">.rating-value</span>
          <span class="o">=</span> <span class="nt">club</span><span class="nc">.rating_average</span>
      <span class="nt">span</span><span class="nc">.reservation-btn-wrapper</span>
        <span class="o">/</span> <span class="nt">club_new_order_path</span> <span class="err">возвращает</span> <span class="err">ссылку</span> <span class="err">на</span> <span class="err">странцу</span> <span class="err">оформления</span> <span class="err">брони</span>
        <span class="o">/</span> <span class="err">Например</span><span class="o">,</span> <span class="nt">club_new_order_path</span><span class="o">(</span><span class="nt">1</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="o">/</span><span class="nt">clubs</span><span class="o">/</span><span class="nt">1</span><span class="o">/</span><span class="nt">orders</span><span class="o">/</span><span class="nt">new</span>
        <span class="o">=</span> <span class="nt">link_to</span> <span class="s1">'</span><span class="s2">Забронировать'</span><span class="o">,</span>  <span class="nt">club_new_order_path</span><span class="o">(</span><span class="nt">club</span><span class="o">),</span> <span class="nd">:class</span><span class="o">=&gt;</span><span class="s1">'</span><span class="s2">btn-reservation btn btn-danger'</span>
</pre></div>

<div class="highlight highlight-scss"><pre><span class="cm">/* app/assets/stylesheets/clubs.css.scss.erb */</span>

<span class="cm">/* обертка */</span>
<span class="nc">.club-wrapper-catalog</span><span class="p">{</span>

  <span class="nt">float</span><span class="nd">:left</span><span class="o">;</span>
  <span class="nt">padding</span><span class="nd">:</span> <span class="nt">0</span> <span class="nt">15px</span> <span class="nt">25px</span><span class="o">;</span>
  <span class="nt">width</span><span class="nd">:50</span><span class="err">%</span><span class="o">;</span>

  <span class="o">/*</span> <span class="err">карточка</span> <span class="err">заведения</span> <span class="o">*/</span>
  <span class="nc">.club-div</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
    <span class="na">height</span><span class="o">:</span><span class="mi">210</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">border-color</span><span class="o">:</span><span class="mh">#ccc</span><span class="p">;</span>
    <span class="nt">border-style</span><span class="nd">:solid</span><span class="o">;</span>
    <span class="nt">border-width</span><span class="nd">:1px</span><span class="o">;</span>
    <span class="nt">border-radius</span><span class="nd">:5px</span><span class="o">;</span>
  <span class="p">}</span>
  <span class="cm">/* Название заедения */</span>
  <span class="nc">.title-on-avatar</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span> <span class="n">initial</span><span class="p">;</span>
    <span class="na">text-align</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
    <span class="na">font-size</span><span class="o">:</span> <span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">padding-top</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">max-width</span><span class="o">:</span> <span class="nf">calc</span><span class="p">(</span><span class="mi">100</span><span class="kt">%</span> <span class="o">-</span> <span class="mi">50</span><span class="kt">px</span><span class="p">);</span>
    <span class="na">overflow-x</span><span class="o">:</span> <span class="no">hidden</span><span class="p">;</span>
    <span class="na">white-space</span><span class="o">:</span> <span class="no">nowrap</span><span class="p">;</span>
    <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
    <span class="na">color</span><span class="o">:</span> <span class="nb">black</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* Белая полоска */</span>
  <span class="nc">.white-on-avatar</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
    <span class="na">background-color</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">0</span><span class="mf">.65</span><span class="p">);</span>
    <span class="na">position</span><span class="o">:</span> <span class="no">relative</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* Адрес заведения */</span>
  <span class="nc">.address-on-avatar</span> <span class="p">{</span>
    <span class="na">font-size</span><span class="o">:</span> <span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/* div для рейтинга */</span>
  <span class="nc">.rating</span><span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">9</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* Звездочка рейтинга */</span>
  <span class="nc">.rating-img</span><span class="p">{</span>
    <span class="na">display</span><span class="o">:</span> <span class="no">inline</span><span class="p">;</span>
    <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">7</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* Значение рейтинга */</span>
  <span class="nc">.rating-value</span> <span class="p">{</span>
    <span class="na">padding-left</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* обертка для кнопки "Забронировать" */</span>
  <span class="nc">.reservation-btn-wrapper</span><span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">right</span><span class="p">;</span>
    <span class="na">padding</span><span class="o">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">padding-top</span><span class="o">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">padding-right</span><span class="o">:</span> <span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* кнопка "Забронировать" */</span>
  <span class="nc">.btn-reservation</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span> <span class="mi">135</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">height</span><span class="o">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">padding</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span>
    <span class="na">padding-top</span><span class="o">:</span> <span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">font-size</span><span class="o">:</span><span class="mi">17</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* Фильтры поиска */</span>
<span class="nt">div</span><span class="nc">.catalog-filter</span> <span class="p">{</span>
  <span class="na">border</span><span class="o">:</span> <span class="mi">2</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
  <span class="na">border-radius</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding</span><span class="o">:</span> <span class="mi">19</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">13</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">width</span><span class="o">:</span> <span class="nf">calc</span><span class="p">(</span><span class="mi">100</span><span class="kt">%</span> <span class="o">+</span> <span class="mi">50</span><span class="kt">px</span><span class="p">);</span>
  <span class="na">margin-left</span><span class="o">:</span> <span class="mi">-30</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/* ссылки в фильтрах поиска */</span>
<span class="nt">div</span><span class="nc">.catalog-filter</span> <span class="nt">a</span> <span class="p">{</span>
  <span class="na">text-decoration</span><span class="o">:</span> <span class="no">underline</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h2>4.2 Заказы</h2>

<p><a href="2%20development/fig.8.png" target="_blank"><img src="2%20development/fig.8.png" alt="fig.8" style="max-width:100%;"></a><br><em>Рис. 8 страница оформления заказа</em><br>
После оформления заказа запрашивается код подтверждения, который присылается на указанный пользователем номер телефона. Реализуем эту логику.<br>
Для начала добавим поле для кода подтверждения:</p>

<pre lang="shell"><code>SmartReserve&gt; rails generate migration AddConfirmationToOrders confirmation_code:string
</code></pre>

<p>Еще одно поле потребуется, чтобы отличать подтвержденные заказы от неподтвержденных:</p>

<pre lang="shell"><code>SmartReserve&gt; rails generate migration AddConfirmdToOrders confirmed:boolean
</code></pre>

<p>Применяем миграции</p>

<pre lang="shell"><code>SmartReserve&gt; rake db:migrate
</code></pre>

<p>Изменим описание модели:</p>

<div class="highlight highlight-ruby"><pre><span class="c1"># app/models/order.rb</span>
<span class="k">class</span> <span class="nc">Order</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:club</span>
  <span class="n">belongs_to</span> <span class="ss">:table</span>

  <span class="c1"># после каждого вызова Order.new будет вызываться set_confirmation</span>
  <span class="n">after_initialize</span> <span class="ss">:set_confirmation</span> 

  <span class="c1"># генереирует геттер и сеттер для подтверждения, введенного пользователем</span>
  <span class="kp">attr_accessor</span> <span class="ss">:user_confirmation</span> 

  <span class="c1"># перед сохранением в базу вызывается validate_confirmation</span>
  <span class="n">before_save</span> <span class="ss">:validate_confirmation</span> 

  <span class="c1"># Услуги рассылки смс пердоставляет множество сервисов, а пока ограничимся записью в лог</span>
  <span class="k">def</span> <span class="nf">send_sms</span>
    <span class="nb">puts</span> <span class="nb">self</span><span class="o">.</span><span class="n">confirmation_code</span>
  <span class="k">end</span>

  <span class="kp">protected</span>
    <span class="k">def</span> <span class="nf">set_confirmation</span>
      <span class="c1"># просто семь цифр</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">confirmation_code</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">9999999</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span> 
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">validate_confirmation</span>
      <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">user_confirmation</span> <span class="o">==</span> <span class="nb">self</span><span class="o">.</span><span class="n">confirmation_code</span>
        <span class="nb">self</span><span class="o">.</span><span class="n">confirmed</span> <span class="o">=</span> <span class="kp">true</span>
      <span class="k">else</span>
        <span class="c1"># Добавляет ошибку к объекту</span>
        <span class="c1"># Такой объект не сможет сохраниться в базе</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="ss">:user_confirmation</span><span class="p">,</span> <span class="s2">"is incorrect"</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>И контроллера:</p>

<div class="highlight highlight-ruby"><pre><span class="c1"># app/controllers/orders_controller.rb</span>
<span class="k">class</span> <span class="nc">OrdersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="c1"># set_order выполнится перед каждым из указанных методов</span>
  <span class="n">before_action</span> <span class="ss">:set_order</span><span class="p">,</span> <span class="ss">only</span><span class="p">:</span> <span class="o">[</span><span class="ss">:show</span><span class="p">,</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:destroy</span><span class="p">,</span> <span class="ss">:confirm</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">new</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="vi">@order</span> <span class="o">=</span> <span class="no">Order</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">order_params</span><span class="p">)</span>
    <span class="c1"># Для демонстрационных целей в поле ввода уже будет подтверждение</span>
    <span class="vi">@order</span><span class="o">.</span><span class="n">user_confirmation</span> <span class="o">=</span> <span class="vi">@order</span><span class="o">.</span><span class="n">confirmation_code</span> 
    <span class="k">if</span> <span class="vi">@order</span><span class="o">.</span><span class="n">save</span> <span class="c1"># сохранит объект в базу</span>
      <span class="c1"># Выводим форму подтверждения</span>
      <span class="n">render</span> <span class="ss">:confirm</span>
    <span class="k">else</span>
      <span class="c1"># Метод save возвращает false, если объект не сохранен.</span>
      <span class="c1"># Например, у него есть ошибки или какие-то неполадки в базе</span>
      <span class="c1"># Тогда выведем обратно форму оформления заказа. В ней уже предусмотрен вывод ошибок</span>
      <span class="n">render</span> <span class="ss">:new</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">confirm</span>
    <span class="k">if</span> <span class="vi">@order</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">order_params</span><span class="p">)</span>
      <span class="c1"># перенаправление на страницу заказа</span>
      <span class="n">redirect_to</span> <span class="vi">@order</span>
    <span class="k">else</span>
      <span class="c1"># update, как и save, возвращает false, если что-то пошло не так</span>
      <span class="n">render</span> <span class="ss">:confirm</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="c1"># Повторяющуюся операцию вынесем в отдельный метод</span>
    <span class="k">def</span> <span class="nf">set_order</span>
      <span class="vi">@order</span> <span class="o">=</span> <span class="no">Order</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="c1"># Не стоит доверять всему, что пришло из интернета. </span>
    <span class="c1"># Метод оставит в хэше params только указанные параметры.</span>
    <span class="k">def</span> <span class="nf">order_params</span>
      <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:order</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:phone</span><span class="p">,</span> <span class="ss">:time</span><span class="p">,</span> <span class="ss">:user_confirmation</span><span class="p">,</span> <span class="ss">:table_id</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>Добавим представление</p>

<div class="highlight highlight-scss"><pre><span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">orders</span><span class="o">/</span><span class="nt">new</span><span class="nc">.html.slim</span>
<span class="nc">.col-md-8.col-md-offset-2</span>
  <span class="nt">h2</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">font-weight:bold'</span><span class="o">]</span> <span class="err">Бронирование</span>
  <span class="nn">#orders_form</span><span class="nc">.content</span>
    <span class="o">==</span> <span class="nt">render</span> <span class="s2">"orders/form"</span>
  <span class="o">/</span> <span class="err">Содержимое</span> <span class="err">модального</span> <span class="err">окна</span> <span class="err">будет</span> <span class="err">изменено</span> <span class="err">с</span> <span class="err">ответом</span> <span class="err">сервера</span>
    <span class="err">А</span> <span class="err">пока</span> <span class="err">что</span> <span class="err">оно</span> <span class="err">пустое</span>
  <span class="nn">#confirmation_dialog</span><span class="nc">.modal.fade</span> <span class="nt">tabindex</span><span class="o">=</span><span class="s2">"-1"</span> 

  <span class="nn">#succes_dialog</span><span class="nc">.modal.fade</span> <span class="nt">tabindex</span><span class="o">=</span><span class="s2">"-1"</span>
    <span class="nc">.modal-dialog</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"width:363px"</span>
      <span class="nc">.modal-content</span>          
        <span class="nc">.modal-body</span>
          <span class="nt">h4</span><span class="nn">#myModalLabel</span><span class="nc">.modal-title.red</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">text-align:center'</span><span class="o">]</span>
            <span class="o">|</span> <span class="err">Ждем</span> <span class="err">вас</span> 
            <span class="nt">span</span><span class="nn">#succes_date</span> <span class="o">/</span> <span class="err">с</span> <span class="err">ответом</span> <span class="err">сервера</span> <span class="err">сюда</span> <span class="err">попадет</span> <span class="err">дата</span> <span class="err">заказа</span>
            <span class="o">|</span>  <span class="err">в</span> 
            <span class="nt">span</span><span class="nn">#succes_time</span> <span class="o">/</span> <span class="err">а</span> <span class="err">сюда</span> <span class="nt">-</span> <span class="err">время</span>
          <span class="nt">div</span> <span class="nt">style</span><span class="o">=</span><span class="s2">"text-align:center"</span>
            <span class="nt">a</span><span class="nc">.btn.btn-primary</span> <span class="nt">href</span><span class="o">=</span><span class="s2">"home"</span> <span class="nt">data-dismiss</span><span class="o">=</span><span class="s2">"modal"</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="err">ОК</span>

<span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">orders</span><span class="o">/</span><span class="nt">_form</span><span class="nc">.html.slim</span>
<span class="nc">.row</span>
  <span class="o">/</span> <span class="err">если</span> <span class="err">в</span> <span class="err">хэлпер</span> <span class="nt">form_for</span> <span class="err">передать</span> <span class="err">объект</span><span class="o">,</span> <span class="err">то</span> <span class="err">все</span> <span class="err">поля</span> <span class="err">формы</span> <span class="err">будт</span> <span class="err">ассоциированы</span> <span class="err">с</span> <span class="err">ним</span>
  <span class="o">=</span> <span class="nt">form_for</span><span class="o">(@</span><span class="nt">order</span><span class="o">,</span> <span class="nt">url</span><span class="nd">:</span> <span class="nt">club_orders_path</span><span class="o">,</span> <span class="nd">:method</span><span class="o">=&gt;</span><span class="nd">:post</span><span class="o">)</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">f</span><span class="o">|</span>
    <span class="nc">.col-md-8</span>
      <span class="nn">#tables_list</span>
        <span class="o">=</span> <span class="nt">render</span> <span class="s2">"tables/list"</span>
    <span class="nc">.col-md-4</span>
      <span class="nc">.order-inputs</span>
        <span class="nt">label</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">font-weight:bold'</span><span class="o">]</span> <span class="err">Введите</span> <span class="err">ваши</span> <span class="err">данные</span><span class="nd">:</span>
        <span class="o">/</span> <span class="err">если</span> <span class="err">в</span> <span class="o">@</span><span class="nt">order</span> <span class="err">есть</span> <span class="err">ошибки</span><span class="o">,</span> <span class="err">они</span> <span class="err">выведутся</span> <span class="err">именно</span> <span class="err">здесь</span>
        <span class="nt">-</span> <span class="nt">if</span> <span class="o">@</span><span class="nt">order</span><span class="nc">.errors.any</span><span class="o">?</span>
          <span class="nn">#error_explanation</span>
            <span class="nt">ul</span>
              <span class="nt">-</span> <span class="o">@</span><span class="nt">order</span><span class="nc">.errors.full_messages.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">msg</span><span class="o">|</span>
                <span class="nt">li</span> <span class="o">=</span> <span class="nt">msg</span>
        <span class="nt">table</span>
          <span class="nt">tr</span>
            <span class="nt">td</span> 
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.label</span> <span class="nd">:name</span>
            <span class="nt">td</span> 
              <span class="o">/</span> <span class="err">такой</span> <span class="err">метод</span> <span class="err">выполнит</span> <span class="err">то</span> <span class="err">же</span><span class="o">,</span> <span class="err">что</span> <span class="err">и</span> 
                <span class="nt">input</span> <span class="nt">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nt">name</span><span class="o">=</span><span class="s2">"order[name]"</span> <span class="nt">value</span><span class="o">=</span><span class="s2">"</span><span class="si">#{</span><span class="o">@</span><span class="ow">or</span><span class="n">der</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span>
                <span class="err">Кроме</span> <span class="err">того</span><span class="o">,</span> <span class="err">если</span> <span class="err">ошибка</span> <span class="err">будет</span> <span class="err">указывать</span> <span class="err">на</span> <span class="err">свойство</span> <span class="nt">name</span><span class="o">,</span> <span class="err">поле</span> <span class="err">обернется</span> <span class="err">в</span> <span class="nt">div</span> <span class="err">с</span> <span class="err">классом</span> <span class="nt">field_with_errors</span>
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.text_field</span> <span class="nd">:name</span>
          <span class="nt">tr</span>  
            <span class="nt">td</span> 
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.label</span> <span class="nd">:phone</span>
            <span class="nt">td</span> 
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.telephone_field</span> <span class="nd">:phone</span>
          <span class="nt">tr</span>  
            <span class="nt">td</span>
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.label</span> <span class="nd">:comment</span>
            <span class="nt">td</span> 
              <span class="o">=</span> <span class="nt">f</span><span class="nc">.text_area</span> <span class="nd">:comment</span>
          <span class="nt">tr</span>
            <span class="nt">td</span>
            <span class="nt">td</span>
              <span class="nc">.actions</span>
                <span class="o">=</span> <span class="nt">f</span><span class="nc">.submit</span> <span class="s1">'</span><span class="s2">Забронировать'</span><span class="o">,</span> <span class="nd">:remote</span> <span class="o">=&gt;</span> <span class="nt">true</span>

<span class="o">/</span> <span class="nt">app</span><span class="o">/</span><span class="nt">views</span><span class="o">/</span><span class="nt">tables</span><span class="o">/</span><span class="nt">_list</span><span class="nc">.html.slim</span>
<span class="nc">.tables-list</span>
  <span class="nc">.tables-inputs</span>
    <span class="nc">.current-time</span>
      <span class="nt">label</span><span class="o">&gt;</span> <span class="err">Текущая</span> <span class="err">дата</span> <span class="err">и</span> <span class="err">время</span><span class="nd">:</span>
      <span class="o">=</span> <span class="nt">Time</span><span class="nc">.now.strftime</span><span class="o">(</span><span class="s1">'</span><span class="s2">%d.%m.%Y %H:%M'</span><span class="o">)</span>
      <span class="o">/</span> <span class="nt">showCurrentState</span><span class="o">()</span> <span class="err">осуществляет</span> <span class="nt">AJAX-</span><span class="err">запрос</span> <span class="err">и</span> <span class="err">отображает</span> <span class="err">ситуацию</span> <span class="err">на</span> <span class="err">текущий</span> <span class="err">момент</span>
      <span class="nt">a</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s1">'</span><span class="s2">float:right;cursor:pointer'</span> <span class="nt">onclick</span><span class="o">=</span><span class="s2">"showCurrentState()"</span><span class="o">]</span> <span class="err">Отобразить</span> <span class="err">на</span> <span class="err">текущий</span> <span class="err">момент</span>
    <span class="nc">.row</span><span class="nd">:</span> <span class="nt">col-md-12</span><span class="nd">:</span> <span class="nt">br</span>
    <span class="nt">div</span><span class="o">[</span><span class="nt">style</span><span class="o">=</span><span class="s2">"height:20px"</span><span class="o">]</span>
      <span class="nc">.date-inputs</span>
        <span class="nt">label</span> <span class="err">Выберите</span> <span class="err">дату</span> 
        <span class="nt">input</span><span class="nn">#datepicker</span> <span class="nt">name</span><span class="o">=</span><span class="s2">"date"</span>
      <span class="nc">.time-inputs</span> 
        <span class="nt">div</span>
        <span class="nt">label</span> <span class="err">Выберите</span> <span class="err">время</span> 
        <span class="nc">.time-select</span><span class="nd">:</span> <span class="nt">select</span><span class="o">[</span><span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">hour'</span><span class="o">]</span>
          <span class="nt">-</span> <span class="o">(</span><span class="s1">'</span><span class="s2">00'</span><span class="nc">..</span><span class="s1">'</span><span class="s2">23'</span><span class="o">)</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">k</span><span class="o">|</span>
            <span class="nt">option</span><span class="o">[</span><span class="nt">value</span><span class="o">=</span><span class="nt">k</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">hour'</span><span class="o">]</span> <span class="o">=</span> <span class="nt">k</span>
        <span class="nc">.time-select</span><span class="nd">:</span> <span class="nt">select</span><span class="o">[</span><span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">minute'</span><span class="o">]</span>
          <span class="nt">-</span> <span class="o">(</span><span class="s1">'</span><span class="s2">00'</span><span class="nc">..</span><span class="s1">'</span><span class="s2">55'</span><span class="o">)</span><span class="nc">.step</span><span class="o">(</span><span class="nt">5</span><span class="o">)</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">k</span><span class="o">|</span>
              <span class="nt">option</span><span class="o">[</span><span class="nt">value</span><span class="o">=</span><span class="nt">k</span> <span class="nt">name</span><span class="o">=</span><span class="s1">'</span><span class="s2">minute'</span><span class="o">]</span> <span class="o">=</span> <span class="nt">k</span>

  <span class="nn">#tables_schema</span>
    <span class="nn">#tables_radios</span>
      <span class="nt">-</span> <span class="o">@</span><span class="nt">tables</span><span class="nc">.each</span> <span class="nt">do</span> <span class="o">|</span><span class="nt">table</span><span class="o">|</span>
        <span class="nc">.table-cell</span>
          <span class="o">/</span> <span class="err">Настоящие</span> <span class="nt">radio</span> <span class="err">спрятаны</span> <span class="err">под</span> <span class="err">изображением</span> <span class="err">столика</span>
          <span class="o">/</span> <span class="err">По</span> <span class="err">клику</span> <span class="err">на</span> <span class="err">изображение</span> <span class="err">оно</span> <span class="err">меняется</span> <span class="err">и</span> <span class="err">выбирается</span> <span class="err">соответствующий</span> <span class="nt">radio</span>
          <span class="nc">.table-wrapper</span><span class="o">[</span><span class="nt">onclick</span><span class="o">=</span><span class="s2">"onTableClick(this)"</span><span class="o">]</span>
            <span class="o">=</span> <span class="nt">radio_button_tag</span> <span class="s2">"order[table_id]"</span><span class="o">,</span> <span class="s2">"</span><span class="si">#{</span><span class="n">table</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="o">,</span> <span class="o">@</span><span class="nt">table_id</span><span class="o">==</span><span class="nt">table</span><span class="nc">.id</span>   
            <span class="o">/</span> <span class="nt">get_table_color</span> <span class="err">возвращает</span> <span class="err">класс</span> <span class="err">для</span> <span class="err">столика</span> <span class="err">цвета</span> <span class="err">соответствующего</span> <span class="err">его</span> <span class="err">состоянию</span><span class="nd">:</span>
              <span class="err">красный</span> <span class="nt">--</span> <span class="err">занят</span>
              <span class="err">желтый</span> <span class="nt">--</span> <span class="err">забронирован</span>
              <span class="err">зеленый</span> <span class="nt">--</span> <span class="err">свободен</span>       
            <span class="nt">div</span><span class="o">[</span><span class="nt">class</span><span class="o">=</span><span class="s2">"table </span><span class="si">#{</span><span class="nf">get_table_color</span><span class="p">(</span><span class="n">table</span><span class="o">,</span> <span class="o">@</span><span class="n">time</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="s1">'</span><span class="s2">active'</span> <span class="n">if</span> <span class="o">@</span><span class="n">table_id</span> <span class="o">==</span> <span class="n">table</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="o">]</span>
              <span class="nc">.table-number</span>
                <span class="o">=</span> <span class="nt">table</span><span class="nc">.number</span>
            <span class="nc">.chair</span>
              <span class="nc">.chair-number</span>
                <span class="o">=</span> <span class="nt">table</span><span class="nc">.seats</span>
    <span class="nn">#tables_legend</span>
      <span class="nc">.row</span>
        <span class="nc">.col-xs-4</span>
          <span class="o">/</span> <span class="err">класс</span> <span class="err">для</span> <span class="err">кружков</span> <span class="err">разных</span> <span class="err">цветов</span>
          <span class="nt">span</span><span class="nc">.circle.circle-free</span> 
          <span class="o">|</span>   <span class="err">Свободно</span>  
        <span class="nc">.col-xs-4</span>
          <span class="nt">span</span><span class="nc">.circle.circle-booked</span> 
          <span class="o">|</span>   <span class="err">Забронироано</span>  
        <span class="nc">.col-xs-4</span>
          <span class="nt">span</span><span class="nc">.circle.circle-busy</span> 
          <span class="o">|</span>   <span class="err">Занято</span>

</pre></div>

<div class="highlight highlight-scss"><pre><span class="cm">/* app/assets/stylesheets/tables.css.scss.erb */</span>
<span class="cm">/* Три класса для столиков разных цветов */</span>
<span class="nc">.table-free</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span><span class="mh">#2ecc71</span>
<span class="p">}</span>
<span class="nc">.table-busy</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.table-booked</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span> <span class="mh">#f1c40f</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Кружки легенды */</span>
<span class="nc">.circle</span><span class="p">{</span>
  <span class="na">width</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">height</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">display</span><span class="o">:</span> <span class="no">inline</span><span class="o">-</span><span class="no">block</span><span class="p">;</span>
  <span class="na">border-radius</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">position</span><span class="o">:</span> <span class="no">relative</span><span class="p">;</span>
  <span class="na">top</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.circle-free</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span><span class="mh">#2ecc71</span>
<span class="p">}</span>
<span class="nc">.circle-busy</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.circle-booked</span><span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span> <span class="mh">#f1c40f</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/* Столики заведения */</span>
<span class="nc">.tables-list</span><span class="p">{</span>

  <span class="na">font-size</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
  <span class="cm">/* Схема заведения */</span>
  <span class="nn">#tables_schema</span><span class="p">{</span>
    <span class="na">border</span><span class="o">:</span> <span class="mi">3</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
    <span class="na">border-radius</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>

    <span class="cm">/* Набор переключателей*/</span>
    <span class="nn">#tables_radios</span><span class="p">{</span>
      <span class="na">color</span><span class="o">:</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
      <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="p">;</span>
      <span class="na">display</span><span class="o">:</span> <span class="n">table</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/* Изображение перекючателя */</span>
    <span class="nc">.table-cell</span><span class="p">{</span>
      <span class="na">padding-left</span><span class="o">:</span> <span class="mi">35</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">padding-top</span><span class="o">:</span> <span class="mi">25</span><span class="kt">px</span><span class="p">;</span>
      <span class="nt">float</span><span class="nd">:left</span><span class="o">;</span>
      <span class="nt">display</span><span class="nd">:</span> <span class="nt">table-cell</span><span class="o">;</span>
      <span class="nt">cursor</span><span class="nd">:pointer</span><span class="o">;</span>
      <span class="o">/*</span> <span class="err">Элемент</span> <span class="nt">radio</span> <span class="o">*/</span>
      <span class="nt">input</span><span class="p">{</span>
        <span class="na">display</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="cm">/* Обертка изобраения столика */</span>
    <span class="nc">.table-wrapper</span><span class="p">{</span>
      <span class="nt">position</span><span class="nd">:relative</span><span class="o">;</span>
      <span class="nt">width</span><span class="nd">:130px</span><span class="o">;</span>
      <span class="nt">height</span><span class="nd">:</span> <span class="nt">120px</span><span class="o">;</span>
    <span class="p">}</span>
    <span class="cm">/* Изображение толика */</span>
    <span class="nc">.table</span><span class="p">{</span>
      <span class="na">width</span><span class="o">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">height</span><span class="o">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">background-image</span><span class="o">:</span> <span class="sx">url('&lt;%= asset_path("tables/table1.png")</span> <span class="o">%&gt;</span><span class="s1">'</span><span class="s2">);</span>
      <span class="na">background-repeat</span><span class="o">:</span> <span class="no">no-repeat</span><span class="p">;</span>
      <span class="na">background-position</span><span class="o">:</span> <span class="mi">14</span><span class="kt">px</span> <span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">border-radius</span><span class="o">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
      <span class="nt">position</span><span class="nd">:relative</span><span class="o">;</span>
      <span class="o">/*</span> <span class="err">Номер</span> <span class="err">столика</span> <span class="o">*/</span>
      <span class="nc">.table-number</span><span class="p">{</span>
        <span class="nt">position</span><span class="nd">:absolute</span><span class="o">;</span>
        <span class="nt">top</span><span class="nd">:</span> <span class="nt">42px</span><span class="o">;</span>
        <span class="nt">left</span><span class="nd">:</span> <span class="nt">39px</span><span class="o">;</span>
        <span class="nt">width</span><span class="nd">:</span> <span class="nt">20px</span><span class="o">;</span>
        <span class="nt">text-align</span><span class="nd">:</span> <span class="nt">center</span><span class="o">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="cm">/* Выбранный столик */</span>
    <span class="nc">.table.active</span><span class="p">{</span>
        <span class="na">-webkit-box-shadow</span><span class="o">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">100</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span> <span class="mh">#00ff6c</span><span class="p">;</span>
        <span class="na">-moz-box-shadow</span><span class="o">:</span>    <span class="mi">0</span><span class="kt">px</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">100</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span> <span class="mh">#00ff6c</span><span class="p">;</span>
        <span class="na">box-shadow</span><span class="o">:</span>         <span class="mi">0</span><span class="kt">px</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">100</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span> <span class="mh">#00ff6c</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cm">/* Изображения стула */</span>
    <span class="nc">.chair</span><span class="p">{</span>
      <span class="na">width</span><span class="o">:</span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">height</span><span class="o">:</span><span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">background-image</span><span class="o">:</span> <span class="sx">url('&lt;%= asset_path("tables/chair.png")</span> <span class="o">%&gt;</span><span class="s1">'</span><span class="s2">);</span>
      <span class="na">position</span><span class="o">:</span> <span class="no">absolute</span><span class="p">;</span>
      <span class="na">bottom</span><span class="o">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">right</span><span class="o">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
      <span class="cm">/* Колиество мест */</span>
      <span class="nc">.chair-number</span><span class="p">{</span>
        <span class="na">position</span><span class="o">:</span> <span class="no">absolute</span><span class="p">;</span>
        <span class="na">position</span><span class="o">:</span> <span class="no">absolute</span><span class="p">;</span>
        <span class="na">left</span><span class="o">:</span> <span class="mi">17</span><span class="kt">px</span><span class="p">;</span>
        <span class="na">width</span><span class="o">:</span> <span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
        <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="cm">/* Легенда схемы */</span>
    <span class="nn">#tables_legend</span> <span class="p">{</span>
      <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
      <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/* Поля ввода для даты  времени */</span>
  <span class="nc">.tables-inputs</span><span class="p">{</span>
    <span class="cm">/* Пдписи полей */</span>
    <span class="nt">label</span><span class="p">{</span>
      <span class="nt">display</span><span class="nd">:inline</span><span class="o">;</span>
      <span class="nt">font-size</span><span class="nd">:</span> <span class="nt">15px</span><span class="o">;</span>
    <span class="p">}</span>
    <span class="cm">/* сслыки */</span>
    <span class="nt">a</span><span class="p">{</span>
      <span class="na">text-decoration</span><span class="o">:</span> <span class="no">underline</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cm">/* Поле ввода даты */</span>
    <span class="nc">.date-inputs</span><span class="p">{</span>
      <span class="nt">float</span><span class="nd">:left</span><span class="o">;</span>
    <span class="p">}</span>
    <span class="cm">/* поле ввода времени */</span>
    <span class="nc">.time-inputs</span><span class="p">{</span>
      <span class="nt">float</span><span class="nd">:right</span><span class="o">;</span>
      <span class="nt">display</span><span class="nd">:inline-flex</span><span class="o">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* app/assets/stylesheets/orders.css.scss */</span>
<span class="cm">/* кнопки с красными границами */</span>
<span class="nt">div</span> <span class="o">&gt;</span> <span class="nc">.btn-red-border</span> <span class="p">{</span>
  <span class="na">background-color</span><span class="o">:</span> <span class="mh">#ffffff</span><span class="p">;</span>
  <span class="na">border-color</span><span class="o">:</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
  <span class="na">border-width</span><span class="o">:</span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
  <span class="na">height</span><span class="o">:</span> <span class="mi">36</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span><span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">height</span><span class="o">:</span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="cm">/* Перепишем стили bootstrap'а */</span>
  <span class="nt">a</span><span class="p">{</span>
  <span class="na">color</span><span class="o">:</span><span class="mh">#ec5c5c</span><span class="p">;</span>
  <span class="na">vertical-align</span><span class="o">:</span> <span class="no">middle</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">a</span><span class="nd">:hover</span><span class="p">{</span>
    <span class="na">color</span><span class="o">:</span><span class="mh">#ec5c5c</span><span class="p">;</span>
    <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* форма оформления заказа */</span>
<span class="nn">#orders_form</span><span class="p">{</span>
  <span class="na">border</span><span class="o">:</span> <span class="mi">3</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#ec5c5c</span><span class="p">;</span>
  <span class="na">padding</span><span class="o">:</span> <span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/* поля ввода */</span>
<span class="nc">.order-inputs</span><span class="p">{</span>
  <span class="nt">input</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">textarea</span><span class="p">{</span>
    <span class="na">width</span><span class="o">:</span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="cm">/* выравниваем поля ввода с помощью таблицы */</span>
  <span class="nt">td</span><span class="p">{</span>
    <span class="na">padding</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span><span class="p">;</span>
    <span class="na">padding-right</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2>ЗАКЛЮЧЕНИЕ</h2>

<p>В ходе выполнения курсовой работы было создано полнофункциональное веб-приложение, полностью готовое к использованию. Сервис SmartReserve предоставляет возможность бронирования столиков в заведениях города в режиме онлайн в течение нескольких мгновений. С его помощью пользователи могут организовать свой досуг или деловую встречу, без дорогостоящих звонков и ожиданий на телефонной линии.<br>
Сайт был создан при помощи популярного фреймворка Ruby on Rails. Для него имеется множество плагинов и готовых решений, что позволяет создать приложения любой сложности. Одной из причин выбора данного фреймворка является возможность увеличения функциональности сайта с помощью плагинов и легкость в создании и изменении функционала.<br>
Поставленные в начале работы цели и задачи были полностью решены при выполнении этой курсовой работы. При выполнении работы были получены знания о верстке веб-страниц и ООП, практические навыки по разработке веб-приложений с использованием самых современных технологий.</p>

<h2>СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ</h2>

<ol class="task-list">
<li>Sam Ruby, Dave Thomas, David Heinemeier Hansson.&nbsp;Agile Web Development with Rails, 2010. - 472 с.</li>
<li>Armando Fox, David Patterson. Engineering Long-Lasting Software: An Agile Approach Using SaaS and Cloud Computing, 2012. - 355 с.</li>
<li>W3Schools [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://w3schools.com/">http://w3schools.com/</a>
</li>
<li>jQuery [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://jquery.com/">http://jquery.com/</a>
</li>
<li>Bootstrap [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://getbootstrap.com/">http://getbootstrap.com/</a>
</li>
<li>CSS-Tricks [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://css-tricks.com/">http://css-tricks.com/</a>
</li>
<li>Ruby on Rails API [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://api.rubyonrails.org/">http://api.rubyonrails.org/</a>
</li>
<li>Ruby on Rails Guides [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://guides.rubyonrails.org/">http://guides.rubyonrails.org/</a>
</li>
<li>Ruby-Doc.org [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://www.ruby-doc.org/">http://www.ruby-doc.org/</a>
</li>
<li>APIdock [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://apidock.com/">http://apidock.com/</a>
</li>
<li>GitHub [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="https://github.com/">https://github.com/</a>
</li>
<li>RVM: Ruby Version Manager [Электронный ресурс]. – Электронные данные. – Режим доступа: <a href="http://rvm.io/">http://rvm.io/</a>
</li>
</ol>